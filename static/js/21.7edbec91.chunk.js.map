{"version":3,"sources":["constant/InsightTypeTrans.js","constant/RecommendedInsightColor.js","components/SeiresView/SequenceView/InsightCardView/helper.js","constant/InsightTypeZh.js","pages/ExportPage/StorylineWebView/TimeLineSlot.js","constant/ActionColor.js","pages/ExportPage/StorylineWebView/StorylineWebView.js"],"names":["trend","forecasting","frequent_pattern","seasonality","univariate_outlier","univariate_distribution","similarity","multivariate_outlier","multivariate_distribution","clustering","outstanding","autocorrelation","insightColors","hightlightItem","script","parameter","indexOf","srtStartIndex","newScript","substring","length","TimeLineSlot","props","parseCaptionStyleToEmpty","styleHlight","innerHTML","React","createRef","desFitRef","textFitRef","headerRef","state","this","insightSpec","captionId","timeValue","factType","currentLocale","sequence","index","visNode","vis","children","chartType","x","originChartSize","width","y","height","style","transform","caption","undefined","genFactSentence","fact","oriBlock","action","parseCaptionStyle","styles","_child","offsetHeight","contentEditable","spellCheck","data","newScrpit","timeStr","blockValue","start","end","subspace","replace","font_min_size","exportSpec","chart","id","toString","showTooltip","className","display","flexDirection","outline","InsightTypeTrans","toLowerCase","outlineOffset","ref","node","overflow","spec","lineHeight","key","el","mode","max","computeDesScripts","onReady","parseScript","paddingTop","min","computeDes","titleFitReady","InsightTypeZh","Component","StorylineWebView","onStart","onStop","onDrag","moving","direction","sign","_whichOpacity","values","tl","olRef","tlStyle","getComputedStyle","tlTransform","getPropertyValue","parseInt","split","setState","timelineTransform","setTimeout","_checkVisibility","isElementInViewport","firstOrLast","rect","getBoundingClientRect","rect_p","parentNode","right","left","last_item","lastItem","rightOpacity","first_item","firstItem","leftOpacity","titleRef","onetimeRef","timelineWidth","activeDrags","minFontSizeTitle","containerHeight","visContainerSize","location","filter","insight","i","type","factTypeIncluced","actionIncluded","item","includes","push","hasOwnProperty","console","log","actions","dragHandlers","position","paddingBottom","opacity","onClick","margin","viewBox","focusable","data-icon","fill","aria-hidden","d","axis","cancel","enableUserSelectHack","map","backgroundImage","ActionColor","passOnClick","handleClickDiv","backgroundColor","ActionType","ActionTypeZh"],"mappings":"kKAAe,KACXA,MAAO,QACPC,YAAa,cACbC,iBAAkB,aAClBC,YAAa,cACbC,mBAAoB,UACpBC,wBAAyB,eACzBC,WAAY,aACZC,qBAAsB,UACtBC,0BAA2B,cAC3BC,WAAY,aACZC,YAAa,UACbC,gBAAiB,oB,iCCZrB,kCAAO,IAAMC,EAAgB,CACzB,MAAS,UACT,YAAe,UAGf,YAAe,UAEf,aAAgB,UAChB,WAAc,UACd,QAAW,UACX,YAAe,UACf,WAAc,WACd,gBAAmB,UACnB,QAAW,UACX,KAAQ,U,iCCbZ,kCAAO,IAAMC,EAAiB,SAAUC,EAAQC,GAC5C,IAAmC,IAA/BD,EAAOE,QAAQD,GAAmB,OAAOD,EAC7C,IAAIG,EAAgBH,EAAOE,QAAQD,GAC/BG,EAAYJ,EAAOK,UAAU,EAAGF,EAAgBF,EAAUK,QAAU,cAAgBN,EAAOK,UAAUF,EAAgBF,EAAUK,QAEnI,OADAF,EAAYA,EAAUC,UAAU,EAAGF,GAAiB,wCAA0CC,EAAUC,UAAUF,K,iCCLvG,KACXjB,MAAO,eACPC,YAAa,eACbC,iBAAkB,qBAClBC,YAAa,qBACbC,mBAAoB,eACpBC,wBAAyB,eACzBC,WAAY,qBACZC,qBAAsB,eACtBC,0BAA2B,qBAC3BC,WAAY,eACZC,YAAa,eACbC,gBAAiB,6B,mNCFAU,EAAY,kDAC7B,WAAYC,GAAQ,IAAD,EAQd,OARc,qBACf,cAAMA,IAoGVC,yBAA2B,WAClB,EAAKC,cAGV,EAAKA,YAAYC,UAAY,KAvG7B,EAAKD,YAAcE,IAAMC,YACzB,EAAKC,UAAYF,IAAMC,YACvB,EAAKE,WAAaH,IAAMC,YACxB,EAAKG,UAAYJ,IAAMC,YACvB,EAAKI,MAAQ,GAEZ,EAiLJ,OAhLA,8CACD,WACI,MAAwFC,KAAKV,MAArFW,EAAW,EAAXA,YAAaC,EAAS,EAATA,UAAWC,EAAS,EAATA,UAAWC,EAAQ,EAARA,SAAUC,EAAa,EAAbA,cAAeC,EAAQ,EAARA,SAAUC,EAAK,EAALA,MAE9E,GAAIP,KAAKQ,QAAS,CACd,IAAIC,EAAMT,KAAKQ,QAAQE,SAAS,GAChC,GAAID,EAAK,CACL,IAAIE,EAAYX,KAAKV,MAAMc,SACvBQ,EAAI,IAAMC,IAAgBF,GAAWG,MACrCC,EAAI,IAAMF,IAAgBF,GAAWK,OACzCP,EAAIQ,MAAMC,UAAS,iBAAaN,EAAC,mBAAWG,EAAC,MAGrD,IAAII,EAAU,GACM,UAAhBlB,QAA2CmB,IAAhBnB,IAC3BkB,EAAUE,YAAgBpB,EAAYqB,KAAMhB,EAASC,GAAOgB,SAAUnB,EAAUC,EAAeH,EAAWC,EAAWG,EAASC,GAAOiB,QAEzIxB,KAAKyB,kBAAkBxB,EAAYqB,KAAMH,EAAShB,MACrD,kCACD,cACC,gCACD,WACI,GAAIH,KAAKQ,QAAS,CACd,IAAIC,EAAMT,KAAKQ,QAAQE,SAAS,GAChC,GAAID,EAAK,CACL,IAAIE,EAAYX,KAAKV,MAAMc,SACvBQ,EAAI,IAAMC,IAAgBF,GAAWG,MACrCC,EAAI,IAAMF,IAAgBF,GAAWK,OACzCP,EAAIQ,MAAMC,UAAS,iBAAaN,EAAC,mBAAWG,EAAC,SAGxD,wBACD,WACI,IAAIW,EAAS,CACbA,MAAkB,OAClBA,OAAmB,cACnBA,aAAyB,WACzBA,QAAoB,cACpBA,gBAA4B,WAC5BA,gBAA4B,IAC5BA,SAAqB,SACrBA,WAAuB,QACvB,OAAOA,IACV,+BACD,WACI,IAAIA,EAAS,CACbA,MAAkB,OAClBA,OAAmB,OACnBA,aAAyB,WACzBA,QAAoB,cACpBA,gBAA4B,WAC5BA,gBAA4B,IAC5BA,UAAsB,SACtBA,UAAsB,aACtB,OAAOA,IACV,yBAED,WAES1B,KAAKJ,YAGNI,KAAKJ,UAAU+B,OAAOC,cAAgB,IACtC5B,KAAKJ,UAAU+B,OAAOV,MAAM,aAAe,OAC3CjB,KAAKJ,UAAU+B,OAAOV,MAAM,oBAAsB,WAClDjB,KAAKJ,UAAU+B,OAAOV,MAAM,eAAiB,MAG7CjB,KAAKJ,UAAU+B,OAAOV,MAAMC,UAAY,WACxClB,KAAKJ,UAAU+B,OAAOV,MAAM,aAAe,OAC3CjB,KAAKJ,UAAU+B,OAAOV,MAAM,oBAAsB,WAClDjB,KAAKJ,UAAU+B,OAAOV,MAAM,eAAiB,KAGjDjB,KAAKJ,UAAU+B,OAAOE,iBAAkB,EACxC7B,KAAKJ,UAAU+B,OAAOG,YAAa,KACtC,2BAGD,cAYC,+BAOD,SAAkBR,EAAMH,EAASY,GAC7B,MAAqD/B,KAAKV,MAAlDgB,EAAQ,EAARA,SAAUF,EAAQ,EAARA,SAAUG,EAAK,EAALA,MAAOF,EAAa,EAAbA,cACnC,GAAKL,KAAKJ,UAAU+B,aAGPP,IAATW,EAAJ,CAGA,IAAIC,EAAY,GACZC,EAAU,GACVC,EAAa5B,EAASC,GAAiB,SAAE,GAAU,MAAE,GAErD0B,EADa,eAAb7B,GAA0C,qBAAbA,GAAgD,gBAAbA,EACtD2B,EAAKG,EAAWC,OAAM,UAAwB,UAAlB9B,EAA4B,QAAU,UAAQ0B,EAAKG,EAAWE,KAGhGd,EAAKe,SAASjD,OAAS,EACb2C,EAAKT,EAAKe,SAAS,IAAG,UAAwB,UAAlBhC,EAA4B,QAAU,UAAQ0B,EAAKT,EAAKe,SAAS,IAE7FN,EAAK,GAAE,UAAwB,UAAlB1B,EAA4B,QAAU,UAAQ0B,EAAKA,EAAK3C,OAAS,IAGjD,IAA3C+B,EAAQnC,QAAQ,wBAChBgD,EAAYnD,YAAesC,EAASc,GACpCD,EAAYnD,YAAemD,EAAWC,EAAQK,QAAQ,MAAO,QAEjEtC,KAAKJ,UAAU+B,OAAOlC,UAAYuC,KAErC,oBAED,WAAU,IAAD,OACL,EAAuGhC,KAAKV,MAApGgB,EAAQ,EAARA,SAAUH,EAAS,EAATA,UAAWoC,EAAa,EAAbA,cAAetC,EAAW,EAAXA,YAAaC,EAAS,EAATA,UAAWE,EAAQ,EAARA,SAAUG,EAAK,EAALA,MAAOF,EAAa,EAAbA,cACjFmC,EAAavC,EAUjB,MAPoB,UAAhBA,QAA2CmB,IAAhBnB,IACjBoB,YAAgBpB,EAAYqB,KAAMhB,EAASC,GAAOgB,SAAUnB,EAAUC,EAAeH,EAAWC,EAAWG,EAASC,GAAOiB,QACrIgB,EAAWC,MAAMC,GAAK,UAAYnC,EAAMoC,WAAa,IAAMvC,EAC3DoC,EAAWC,MAAM3B,MAAQD,IAAgBT,GAAUU,MACnD0B,EAAWC,MAAMzB,OAASH,IAAgBT,GAAUY,OACpDwB,EAAWC,MAAMG,aAAc,GAG/B,yBAAKC,UAAU,UAAU5B,MAAO,CAAE6B,QAAS,OAAQC,cAAe,SAAU/B,OAAQ,QAASgC,QAAS,YAAcpE,IAAcqE,IAAiB7C,GAAU8C,eAAgBC,cAAe,SACxL,yBAAKN,UAAU,MAAMO,IAAK,SAACC,GAAI,OAAK,EAAK7C,QAAU6C,GAAMpC,MAAO,CAAEqC,SAAU,WACvD,UAAhBrD,EAA0B,KAAO,kBAAC,IAAK,CAACsD,KAAMf,KAEnD,yBAAKK,UAAU,cAAcf,WAAW,QACpCb,MAAO,CACHuC,WAAY,KAEhBJ,IAAKpD,KAAKR,aAGV,kBAAC,UAAO,CACJiE,IAAKxD,EACLmD,IAAK,SAAAM,GAAE,OAAI,EAAK9D,UAAY8D,GAC5BC,KAAK,QACLC,IAAK,GACL3C,MAAOjB,KAAK6D,oBACZC,QAAS,kBAAM,EAAKC,kBAK5B,yBAAKlB,UAAU,sBAAsBO,IAAK,SAAAM,GAAE,OAAI,EAAK5D,UAAY4D,GAAIzC,MAAO,CAAE+C,WAAY,IACtF,kBAAC,UAAO,CACJZ,IAAK,SAAAM,GAAE,OAAI,EAAK7D,WAAa6D,GAC7Bb,UAAU,OACVc,KAAK,QACLC,IAAK,GACLK,IAAK1B,EACLtB,MAAOjB,KAAKkE,WACZJ,QAAS,kBAAM,EAAKK,kBACD,UAAlB9D,EAA4B4C,IAAiB7C,GAAYgE,IAAchE,UAK3F,EA1L4B,CAASiE,c,+KCV3B,GACX,KAAM,UACN,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,W,oCCIYC,EAAgB,kDACjC,WAAYhF,GAAQ,IAAD,EAed,OAfc,qBACf,cAAMA,IAiBViF,QAAU,aAGR,EAEFC,OAAS,aAGP,EAEFC,OAAS,aAER,EACDC,OAAS,SAACC,GACN,IAAIC,EAAqB,SAAdD,EAAuB,IAAM,IACpCE,EAAgBF,EAAY,UAChC,GArCU,KAqCN,EAAK5E,MAAM8E,GAAf,CACA,IAKIC,EAJAC,EAAK,EAAKC,MACRC,EAAUC,iBAAiBH,GAE3BI,EAAcF,EAAQG,iBAAiB,sBAAwBH,EAAQG,iBAAiB,aAG1FN,EADgB,SAAhBK,EACSE,SAAS,GAAD,OAAIT,GAAI,OAPb,MAUHS,SAASF,EAAYG,MAAM,KAAK,IAAMD,SAAS,GAAD,OAAIT,GAAI,OAVnD,MAYhB,EAAKW,SAAS,CAAEC,kBAAmBV,IACnC,EAAKE,MAAM9D,UAAS,qBAAiB4D,EAAM,OAC3CW,YAAW,WACP,EAAKC,qBACN,OAEN,EACDC,oBAAsB,SAACjC,EAAIkC,GACvB,IAAKlC,EAAI,OAAO,EAChB,IAAMmC,EAAOnC,EAAGoC,wBAEVC,EADSrC,EAAGsC,WAAWA,WAAWA,WAClBF,wBACtB,MAAoB,SAAhBF,EAEIC,EAAKI,OAASF,EAAOE,MAIrBJ,EAAKK,MAAQH,EAAOG,MAI/B,EACDR,iBAAmB,WACf,IAAIS,EAAY,EAAKC,SACjB,EAAKT,oBAAoBQ,EAAW,QACpC,EAAKZ,SAAS,CACVc,aA7EE,KAgFN,EAAKd,SAAS,CACVc,aAhFE,KAmFV,IAAIC,EAAa,EAAKC,UAClB,EAAKZ,oBAAoBW,EAAY,SACrC,EAAKf,SAAS,CACViB,YAvFE,KA0FN,EAAKjB,SAAS,CACViB,YA1FE,MAIV,EAAKC,SAAW/G,IAAMC,YACtB,EAAKyG,SAAW1G,IAAMC,YACtB,EAAK4G,UAAY7G,IAAMC,YACvB,EAAKqF,MAAQtF,IAAMC,YACnB,EAAK+G,WAAa,GAClB,EAAK3G,MAAQ,CACT4G,cAAe,EACfH,YAZM,GAaNH,aAZM,GAaNO,YAAa,EACbpB,kBAAmB,EACnBqB,iBAAkB,GAClBC,gBAAiB,EAAKxH,MAAMyH,iBAAiB/F,OAAS,KACzD,EA2LJ,OAzLD,mCA2EA,WAAU,IAAD,OACL,EAAqChB,KAAKV,MAAM0H,SAASjH,MAAjDM,EAAa,EAAbA,cAAeF,EAAS,EAATA,UACnBG,EAAWN,KAAKV,MAAM0H,SAASjH,MAAMO,SAEzCA,EAAWA,EAAS2G,QAAO,SAACC,EAASC,GAAC,MAAsB,UAAjBD,EAAQE,QAEnD,IAAIC,EAAmB,GACnBC,EAAiB,GACrB,IAAK,IAAIC,KAAQjH,EACR+G,EAAiBG,SAASlH,EAASiH,GAAMH,OAC1CC,EAAiBI,KAAKnH,EAASiH,GAAMH,MAE5B,MAATG,IACIjH,EAASiH,GAAMG,eAAe,gBAAsCtG,GAAzBd,EAASiH,GAAM/F,OACrD8F,EAAeE,SAASlH,EAASiH,GAAM/F,UACxCmG,QAAQC,IAAIL,EAAMjH,EAASiH,IAC3BD,EAAeG,KAAKnH,EAASiH,GAAM/F,SAKlC8F,EAAeE,UAAU,IAC1BF,EAAeG,MAAM,IAKrCE,QAAQC,IAAIN,GACZ,IAAIO,EAAU,GACd,IAAK,IAAIN,KAAQjH,EACA,IAATiH,IACIjH,EAASiH,GAAMG,eAAe,gBAAsCtG,GAAzBd,EAASiH,GAAM/F,OAC1DqG,EAAQJ,KAAKnH,EAASiH,GAAM/F,QAE5BqG,EAAQJ,MAAM,IAK1B,IAAMK,EAAe,CAAEvD,QAASvE,KAAKuE,QAASC,OAAQxE,KAAKwE,OAAQC,OAAQzE,KAAKyE,QAEhF,OADAkD,QAAQC,IAAItH,GAER,yBACIW,MAAO,CACHD,OAAO,GAAD,OAAKhB,KAAKD,MAAM+G,gBAAe,MACrCiB,SAAU,WACV/D,YAAahE,KAAKD,MAAM+G,gBAAkB,KAAO,EAAI,KACrDkB,eAAgBhI,KAAKD,MAAM+G,gBAAkB,KAAO,EAAI,OAE5D,yBAAK7F,MAAO,CAAE6B,QAAS,QAAUD,UAAU,wBAClB,IAApBvC,EAASlB,aAAgCgC,IAAhBd,EAAS,IAAoB,yBAAKuC,UAAS,oBAhJvE,KAgJsF7C,KAAKD,MAAMyG,YAA8B,aAAe,IAAMvF,MAAO,CAAEgH,QAASjI,KAAKD,MAAMyG,aAAe0B,QAAS,kBAAM,EAAKxD,OAAO,UAAS,yBAAKzD,MAAO,CAAEkH,OAAQ,OAAQjH,UAAW,cAAgBkH,QAAQ,gBAAgBC,UAAU,QAAQC,YAAU,OAAOxH,MAAM,MAAME,OAAO,MAAMuH,KAAK,eAAeC,cAAY,QAAO,0BAAMC,EAAE,6LAAuM,KACrmB,yBAAKxH,MAAO,CAAEH,MAAO,OAAS+B,UAAU,oBAEpC,kBAAC,IAAS,eAAC6F,KAAK,IAAIC,OAAO,YAAeb,EAAY,CAAEc,sBAAsB,IAC1E,6BACyB,IAApBtI,EAASlB,aAAgCgC,IAAhBd,EAAS,IAAoB,wBAAI8C,IAAK,SAAAM,GAAE,OAAI,EAAKsB,MAAQtB,GAAIzC,MAAO,CAAEC,UAAU,cAAD,OAAgBlB,KAAKD,MAAMyF,kBAAiB,SAChJlF,EAASuI,KAAI,SAAC3B,EAASC,GACpB,OAAU,IAANA,EACO,wBACH1D,IAAK0D,EACL/D,IAAK,SAAAM,GAAE,OAAI,EAAK6C,UAAY7C,GAC5Bb,UAAWI,IAAiBiE,EAAQE,MAAMlE,cAC1CjC,MAAO,CAAE6H,gBAAgB,6BAAD,OAA+BC,EAAYlB,EAAQV,GAAGxE,YAAW,cAAMoG,EAAYlB,EAAQV,GAAGxE,YAAW,OAGjI,kBAACtD,EAAA,QAAY,eAACiB,SAAUA,EAAUH,UAAWA,EAAWE,cAAeA,EAAeE,MAAO4G,EAAGlH,YAAaiH,EAAQ3D,KAAMrD,UAAWgH,EAAQhH,UAAWE,SAAU8G,EAAQE,KAAM7E,cAAe,IAAQ,EAAKjD,MAAK,CAAE0J,YAAa,EAAKC,mBAEvO,wBACHxF,IAAK0D,EACLtE,UAAWI,IAAiBiE,EAAQE,MAAMlE,cAC1CjC,MAAO,CAAE6H,gBAAgB,6BAAD,OAA+BC,EAAYlB,EAAQV,GAAGxE,YAAW,cAAMoG,EAAYlB,EAAQV,GAAGxE,YAAW,OAGjI,kBAACtD,EAAA,QAAY,eAACiB,SAAUA,EAAUH,UAAWA,EAAWE,cAAeA,EAAeE,MAAO4G,EAAGlH,YAAaiH,EAAQ3D,KAAMrD,UAAWgH,EAAQhH,UAAWE,SAAU8G,EAAQE,KAAM7E,cAAe,IAAQ,EAAKjD,MAAK,CAAE0J,YAAa,EAAKC,sBAO9O,wBAAI7F,IAAK,SAAAM,GAAE,OAAI,EAAK0C,SAAW1C,SAK1B,IAApBpD,EAASlB,aAAgCgC,IAAhBd,EAAS,IAAoB,yBAAKuC,UAAS,oBAnLvE,KAmLsF7C,KAAKD,MAAMsG,aAA+B,aAAe,IAAMpF,MAAO,CAAEgH,QAASjI,KAAKD,MAAMsG,cAAgB6B,QAAS,kBAAM,EAAKxD,OAAO,WAAU,yBAAKzD,MAAO,CAAEkH,OAAQ,OAAQjH,UAAW,cAAgBkH,QAAQ,gBAAgBC,UAAU,QAAQC,YAAU,OAAOxH,MAAM,MAAME,OAAO,MAAMuH,KAAK,eAAeC,cAAY,QAAO,0BAAMC,EAAE,kMAEra,yBAAK5F,UAAU,UAAU5B,MAAO,CAAEH,MAAO,SAEjCuG,EAAiBwB,KAAI,SAACzB,EAAM7G,GACxB,OAAO,yBAAKsC,UAAU,SAASY,IAAKlD,GAChC,0BAAMsC,UAAU,MAAM5B,MAAO,CAAEiI,gBAAgB,GAAD,OAAKtK,IAAcqE,IAAiBmE,GAAMlE,mBACxF,yBAAKL,UAAU,YAA8B,UAAlBxC,EAA4B4C,IAAiBmE,GAAQhD,IAAcgD,QAKtGE,EAAelI,OAAS,EAAI,yBAAKyD,UAAU,iBAAwB,KAGnEyE,EAAeuB,KAAI,SAACrH,EAAQjB,GACxB,OAAO,yBAAKsC,UAAU,SAASY,IAAKlD,GAChC,0BAAMsC,UAAU,OAAO5B,MAAO,CAAEiI,gBAAgB,GAAD,OAAKH,EAAYvH,EAAOmB,gBACvE,yBAAKE,UAAU,YAA8B,UAAlBxC,EAA4B8I,IAAW3H,EAAOmB,YAAcyG,IAAa5H,EAAOmB,uBAOtI,EA3MgC,CAAS0B","file":"static/js/21.7edbec91.chunk.js","sourcesContent":["export default {\r\n    trend: 'Trend',\r\n    forecasting: 'Forecasting',\r\n    frequent_pattern: 'Similarity',\r\n    seasonality: 'Seasonality',\r\n    univariate_outlier: 'Outlier',\r\n    univariate_distribution: 'Distribution',\r\n    similarity: 'Similarity',\r\n    multivariate_outlier: 'Outlier',\r\n    multivariate_distribution: 'Correlation',\r\n    clustering: 'Clustering',\r\n    outstanding: 'Extreme',\r\n    autocorrelation: 'Autocorrelation'\r\n}","export const insightColors = {\r\n    \"trend\": \"#8dd3c7\",\r\n    \"forecasting\": \"#f0e68c\",\r\n    // \"frequent_pattern\": \"#bebada\",\r\n    // \"seasonality\": \"#fb8072\",\r\n    \"seasonality\": \"#80b1d3\",\r\n    // \"univariate_outlier\": \"#80b1d3\",\r\n    \"distribution\": \"#F5DEB3\",\r\n    \"similarity\": \"#b3de69\",\r\n    \"outlier\": \"#fccde5\",\r\n    \"correlation\": \"#d9d9d9\",\r\n    \"clustering\": \" #bc80bd\",\r\n    \"autocorrelation\": \"#bebada\",\r\n    \"extreme\": \"#FF7F50\",\r\n    \"null\": \"white\"\r\n}","\r\nexport const hightlightItem = function (script, parameter) {\r\n    if (script.indexOf(parameter) === -1) return script\r\n    let srtStartIndex = script.indexOf(parameter);\r\n    let newScript = script.substring(0, srtStartIndex + parameter.length) + \"</b></span>\" + script.substring(srtStartIndex + parameter.length);\r\n    newScript = newScript.substring(0, srtStartIndex) + '<span class=\"timeline-hightlight\"><b>' + newScript.substring(srtStartIndex);\r\n    return newScript\r\n}\r\n//只需要时间列的信息\r\n// export const getOriData = function () {\r\n//     let timeValue = []\r\n    \r\n    \r\n//     return timeValue\r\n// }\r\n","export default {\r\n    trend: '趋势',\r\n    forecasting: '预测',\r\n    frequent_pattern: '相似性',\r\n    seasonality: '周期性',\r\n    univariate_outlier: '异常',\r\n    univariate_distribution: '分布',\r\n    similarity: '相似性',\r\n    multivariate_outlier: '异常',\r\n    multivariate_distribution: '关联性',\r\n    clustering: '聚类',\r\n    outstanding: '极值',\r\n    autocorrelation: '自相关性'\r\n}","import React, { Component } from 'react'\r\nimport { Textfit } from '@kyo_ago/react-textfit';\r\nimport { insightColors } from '../../../constant/RecommendedInsightColor';\r\nimport Chart from '../../../insight_charts/Chart';\r\nimport _ from 'lodash';\r\nimport { originChartSize } from '../../../constant/ChartSize';\r\nimport { genFactSentence } from '../../../insight_charts/caption';\r\nimport { hightlightItem } from '../../../components/SeiresView/SequenceView/InsightCardView/helper';\r\nimport InsightTypeTrans from '../../../constant/InsightTypeTrans';\r\nimport InsightTypeZh from '../../../constant/InsightTypeZh';\r\nexport default class TimeLineSlot extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.styleHlight = React.createRef();\r\n        this.desFitRef = React.createRef();\r\n        this.textFitRef = React.createRef();\r\n        this.headerRef = React.createRef();\r\n        this.state = {\r\n\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        const { insightSpec, captionId, timeValue, factType, currentLocale, sequence, index } = this.props\r\n\r\n        if (this.visNode) {\r\n            let vis = this.visNode.children[0];\r\n            if (vis) {\r\n                let chartType = this.props.factType\r\n                let x = 150 / originChartSize[chartType].width\r\n                let y = 120 / originChartSize[chartType].height\r\n                vis.style.transform = `scaleX(${x})scaleY(${y})`;\r\n            }\r\n        }\r\n        let caption = ''\r\n        if (insightSpec !== \"empty\" && insightSpec !== undefined) {\r\n            caption = genFactSentence(insightSpec.fact, sequence[index].oriBlock, factType, currentLocale, captionId, timeValue, sequence[index].action)\r\n        } else return\r\n        this.parseCaptionStyle(insightSpec.fact, caption, timeValue)\r\n    }\r\n    componentWillUnmount() {\r\n    }\r\n    componentDidUpdate() {\r\n        if (this.visNode) {\r\n            let vis = this.visNode.children[0];\r\n            if (vis) {\r\n                let chartType = this.props.factType\r\n                let x = 150 / originChartSize[chartType].width\r\n                let y = 120 / originChartSize[chartType].height\r\n                vis.style.transform = `scaleX(${x})scaleY(${y})`;\r\n            }\r\n        }\r\n    }\r\n    computeDes() {\r\n        let styles = {};\r\n        styles['width'] = '100%';\r\n        styles['height'] = 'fit-content';\r\n        styles['textOverflow'] = 'ellipsis'\r\n        styles['display'] = '-webkit-box'\r\n        styles['WebkitBoxOrient'] = 'vertical'\r\n        styles['WebkitLineClamp'] = '2'\r\n        styles['overflow'] = 'hidden'\r\n        styles['lineHeight'] = '18px'\r\n        return styles\r\n    }\r\n    computeDesScripts() {\r\n        let styles = {};\r\n        styles['width'] = '100%';\r\n        styles['height'] = '75px';\r\n        styles['textOverflow'] = 'ellipsis'\r\n        styles['display'] = '-webkit-box'\r\n        styles['WebkitBoxOrient'] = 'vertical'\r\n        styles['WebkitLineClamp'] = '5'\r\n        styles['overflowY'] = 'scroll'\r\n        styles['wordBreak'] = 'break-all';\r\n        return styles\r\n    }\r\n\r\n    parseScript() {\r\n\r\n        if (!this.desFitRef) {\r\n            return\r\n        }\r\n        if (this.desFitRef._child.offsetHeight >= 75) {\r\n            this.desFitRef._child.style['font-size'] = '10px';\r\n            this.desFitRef._child.style['transform-origin'] = \"top left\";\r\n            this.desFitRef._child.style['line-height'] = 1.1\r\n        } else {\r\n            // console.log(this.desFitRef)\r\n            this.desFitRef._child.style.transform = 'scale(1)';\r\n            this.desFitRef._child.style['font-size'] = '10px';\r\n            this.desFitRef._child.style['transform-origin'] = \"top left\";\r\n            this.desFitRef._child.style['line-height'] = 1.1\r\n        }\r\n        // this.desFitRef._child.innerHTML = hightlight(events[i].fact)\r\n        this.desFitRef._child.contentEditable = false\r\n        this.desFitRef._child.spellCheck = false\r\n    }\r\n\r\n\r\n    titleFitReady() {\r\n        // // console.log('title',i, this.textFitRef, this.state.subtitle, events[i].fact.generatedSubtitle)\r\n        // if (!this.textFitRef) {\r\n        //     return\r\n        // }\r\n        // let padTop = (50 - this.textFitRef._child.offsetHeight) / 2 >= 0 ?(40 - this.textFitRef._child.offsetHeight) / 2  : 0 \r\n        // padTop = this.textFitRef.props.children==='    ' ? 3:padTop\r\n        // this.headerRef.style['padding-top'] = padTop + 'px'\r\n        // this.textFitRef._child.contentEditable=this.props.forPublish? false: events[i].fact.aggregated && events[i].fact.aggregatedFact ? false : true\r\n        // this.textFitRef._child.spellCheck=false\r\n        // this.textFitRef._child.suppressContentEditableWarning= true\r\n        // //this.textFitRef._child.contentEditable = false //设置不能编辑\r\n    }\r\n    parseCaptionStyleToEmpty = () => {\r\n        if (!this.styleHlight) {\r\n            return\r\n        }\r\n        this.styleHlight.innerHTML = \"\"\r\n    }\r\n    parseCaptionStyle(fact, caption, data) {\r\n        const { sequence, factType, index, currentLocale } = this.props\r\n        if (!this.desFitRef._child) {\r\n            return\r\n        }\r\n        if (data === undefined) {\r\n            return\r\n        }\r\n        let newScrpit = ''\r\n        let timeStr = ''\r\n        let blockValue = sequence[index][\"oriBlock\"][0][\"value\"][0]\r\n        if (factType === \"similarity\" || factType === \"frequent_pattern\" || factType === \"seasonality\") {\r\n            timeStr = data[blockValue.start] + `${currentLocale === \"en-US\" ? ' and ' : '到'}` + data[blockValue.end]\r\n        } else {\r\n            //TODO:如果子空间不为空，如果子空间为空则是整个区间范围\r\n            if (fact.subspace.length > 0) {\r\n                timeStr = data[fact.subspace[0]] + `${currentLocale === \"en-US\" ? ' and ' : '到'}` + data[fact.subspace[1]]\r\n            } else {\r\n                timeStr = data[0] + `${currentLocale === \"en-US\" ? ' and ' : '到'}` + data[data.length - 1]\r\n            }\r\n        }\r\n        if (caption.indexOf('timeline-highlight') === -1) {\r\n            newScrpit = hightlightItem(caption, timeStr)\r\n            newScrpit = hightlightItem(newScrpit, timeStr.replace('and', 'to'))\r\n        }\r\n        this.desFitRef._child.innerHTML = newScrpit\r\n        // return newScrpit\r\n    }\r\n\r\n    render() {\r\n        const { sequence, timeValue, font_min_size, insightSpec, captionId, factType, index, currentLocale } = this.props\r\n        let exportSpec = insightSpec\r\n\r\n        let caption = ''\r\n        if (insightSpec !== \"empty\" && insightSpec !== undefined) {\r\n            caption = genFactSentence(insightSpec.fact, sequence[index].oriBlock, factType, currentLocale, captionId, timeValue, sequence[index].action)\r\n            exportSpec.chart.id = 'export-' + index.toString() + '-' + factType\r\n            exportSpec.chart.width = originChartSize[factType].width\r\n            exportSpec.chart.height = originChartSize[factType].height\r\n            exportSpec.chart.showTooltip = false\r\n        }\r\n        return (\r\n            <div className='onetime' style={{ display: 'flex', flexDirection: 'column', height: '250px', outline: '3px solid' + insightColors[InsightTypeTrans[factType].toLowerCase()], outlineOffset: '-3px' }}>\r\n                <div className='vis' ref={(node) => this.visNode = node} style={{ overflow: 'hidden' }}>\r\n                    {insightSpec === \"empty\" ? null : <Chart spec={exportSpec} />}\r\n                </div>\r\n                <div className='des tl-edit' spellCheck=\"false\"\r\n                    style={{\r\n                        lineHeight: 1.5\r\n                    }}\r\n                    ref={this.styleHlight}>\r\n                    {/* {(insightSpec !== \"empty\"&&insightSpec!==undefined) ?this.parseCaptionStyle(insightSpec.fact,caption,timeValue): this.parseCaptionStyleToEmpty()} */}\r\n\r\n                    <Textfit\r\n                        key={insightSpec}\r\n                        ref={el => this.desFitRef = el}\r\n                        mode=\"multi\"\r\n                        max={14}\r\n                        style={this.computeDesScripts()}\r\n                        onReady={() => this.parseScript()}>\r\n                        {/* {(insightSpec !== \"empty\"&&insightSpec!==undefined) ?this.parseCaptionStyle(insightSpec.fact,caption,timeValue): this.parseCaptionStyleToEmpty()} */}\r\n                        {/* {genFactSentence(insightSpec.fact,factType,currentLocale,captionId,timeValue)} */}\r\n                    </Textfit>\r\n                </div>\r\n                <div className='header_type tl-edit' ref={el => this.headerRef = el} style={{ paddingTop: 0 }}>\r\n                    <Textfit\r\n                        ref={el => this.textFitRef = el}\r\n                        className=\"text\"\r\n                        mode=\"multi\"\r\n                        max={30}\r\n                        min={font_min_size}\r\n                        style={this.computeDes}\r\n                        onReady={() => this.titleFitReady()}>\r\n                        {currentLocale === \"en-US\" ? InsightTypeTrans[factType] : InsightTypeZh[factType]}\r\n                    </Textfit>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","export default {\r\n    \"-1\": \"#B0C4DE\",\r\n    \"0\": \"#FF69B4\",\r\n    \"1\": \"#9932CC\",\r\n    \"2\": \"#8A2BE2\",\r\n    \"3\": \"#1E90FF\",\r\n    \"4\": \"#3CB371\",\r\n    \"5\": \"#7cb518\",\r\n    \"6\": \"#CD853F\",\r\n    \"7\": \"#CD5C5C\",\r\n    \"8\": \"#8f2d56\",\r\n    \"9\": \"#d81159\"\r\n}","import React, { Component } from 'react'\r\nimport { insightColors } from '../../../constant/RecommendedInsightColor'\r\nimport Draggable from 'react-draggable';\r\nimport './StorylineWebView.less'\r\nimport TimeLineSlot from './TimeLineSlot';\r\nimport ActionColor from '../../../constant/ActionColor';\r\nimport ActionType from '../../../constant/ActionType';\r\nimport InsightTypeTrans from '../../../constant/InsightTypeTrans';\r\nimport InsightTypeZh from '../../../constant/InsightTypeZh';\r\nimport ActionTypeZh from '../../../constant/ActionTypeZh';\r\n// const factTypeIncluced = [\"trend\", \"frequent_pattern\", \"seasonality\", \"univariate_distribution\"]\r\n\r\nconst notVisable = 0,\r\n    lessVisable = 0.2,\r\n    fullVisable = 0.8\r\nexport default class StorylineWebView extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.titleRef = React.createRef();\r\n        this.lastItem = React.createRef()\r\n        this.firstItem = React.createRef()\r\n        this.olRef = React.createRef();\r\n        this.onetimeRef = {};\r\n        this.state = {\r\n            timelineWidth: 0,\r\n            leftOpacity: lessVisable,\r\n            rightOpacity: fullVisable,\r\n            activeDrags: 0,\r\n            timelineTransform: 0,\r\n            minFontSizeTitle: 18,\r\n            containerHeight: this.props.visContainerSize.height - 320\r\n        }\r\n    }\r\n    // drag\r\n    onStart = () => {\r\n        // let perv_activeDrags = this.state.activeDrags\r\n        // this.setState({ activeDrags: ++perv_activeDrags });\r\n    };\r\n\r\n    onStop = () => {\r\n        // let perv_activeDrags = this.state.activeDrags\r\n        // this.setState({ activeDrags: --perv_activeDrags });\r\n    };\r\n\r\n    onDrag = () => {\r\n        // this._checkVisibility();\r\n    }\r\n    moving = (direction) => {\r\n        let sign = direction === 'left' ? '+' : '-';\r\n        let _whichOpacity = direction + 'Opacity'\r\n        if (this.state[_whichOpacity] === lessVisable) return\r\n        let scrolling = 280;\r\n        let tl = this.olRef;\r\n        const tlStyle = getComputedStyle(tl);\r\n        //   add more browser prefixes if needed here\r\n        const tlTransform = tlStyle.getPropertyValue(\"-webkit-transform\") || tlStyle.getPropertyValue(\"transform\");\r\n        let values;\r\n        if (tlTransform === 'none') {\r\n            values = parseInt(`${sign}${scrolling}`);\r\n        }\r\n        else {\r\n            values = parseInt(tlTransform.split(\",\")[4]) + parseInt(`${sign}${scrolling}`);\r\n        }\r\n        this.setState({ timelineTransform: values });\r\n        this.olRef.transform = `translateX(${values}px)`\r\n        setTimeout(() => {\r\n            this._checkVisibility();\r\n        }, 1000)\r\n\r\n    }\r\n    isElementInViewport = (el, firstOrLast) => {\r\n        if (!el) return false\r\n        const rect = el.getBoundingClientRect();\r\n        const parent = el.parentNode.parentNode.parentNode;\r\n        const rect_p = parent.getBoundingClientRect();\r\n        if (firstOrLast === 'last') {\r\n            return (\r\n                rect.right <= rect_p.right\r\n            );\r\n        } else {\r\n            return (\r\n                rect.left >= rect_p.left\r\n            );\r\n        }\r\n\r\n    }\r\n    _checkVisibility = () => {\r\n        let last_item = this.lastItem;\r\n        if (this.isElementInViewport(last_item, 'last')) {\r\n            this.setState({\r\n                rightOpacity: lessVisable\r\n            })\r\n        } else {\r\n            this.setState({\r\n                rightOpacity: fullVisable\r\n            })\r\n        }\r\n        let first_item = this.firstItem;\r\n        if (this.isElementInViewport(first_item, 'first')) {\r\n            this.setState({\r\n                leftOpacity: lessVisable\r\n            })\r\n        } else {\r\n            this.setState({\r\n                leftOpacity: fullVisable\r\n            })\r\n        }\r\n    }\r\n    render() {\r\n        const { currentLocale, timeValue } = this.props.location.state\r\n        let sequence = this.props.location.state.sequence\r\n        // 去除掉sequence中的空card\r\n        sequence = sequence.filter((insight, i) => insight.type !== \"empty\")\r\n        //解析factTypeList:\r\n        let factTypeIncluced = []\r\n        let actionIncluded = []\r\n        for (let item in sequence) {\r\n            if (!factTypeIncluced.includes(sequence[item].type)) {\r\n                factTypeIncluced.push(sequence[item].type)\r\n            }\r\n            if (item !== \"0\") {\r\n                if (sequence[item].hasOwnProperty(\"action\") && sequence[item].action != undefined) {\r\n                    if (!actionIncluded.includes(sequence[item].action)) {\r\n                        console.log(item, sequence[item])\r\n                        actionIncluded.push(sequence[item].action)\r\n                        // if(sequence[item].action===-1)actionIncluded.push(\"no action\")\r\n                        // else actionIncluded.push(ActionType[sequence[item].action.toSting()])\r\n                    }\r\n                } else {\r\n                    if (!actionIncluded.includes(-1)) {\r\n                        actionIncluded.push(-1)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        console.log(actionIncluded)\r\n        let actions = []\r\n        for (let item in sequence) {\r\n            if (item !== 0) {\r\n                if (sequence[item].hasOwnProperty(\"action\") && sequence[item].action != undefined) {\r\n                    actions.push(sequence[item].action)\r\n                } else {\r\n                    actions.push(-1)\r\n                }\r\n            }\r\n        }\r\n\r\n        const dragHandlers = { onStart: this.onStart, onStop: this.onStop, onDrag: this.onDrag };\r\n        console.log(sequence)\r\n        return (\r\n            <div\r\n                style={{\r\n                    height: `${this.state.containerHeight}px`,\r\n                    position: 'relative',\r\n                    paddingTop: (this.state.containerHeight - 380) / 2 + 'px',\r\n                    paddingBottom: (this.state.containerHeight - 380) / 2 + 'px'\r\n                }}>\r\n                <div style={{ display: 'flex' }} className='export-sequence-line'>\r\n                    {sequence.length !== 0 && sequence[0] !== undefined && <div className={`btn-arrow ${this.state.leftOpacity === fullVisable ? 'enabledBtn' : ''}`} style={{ opacity: this.state.leftOpacity }} onClick={() => this.moving('left')}><svg style={{ margin: 'auto', transform: 'scale(0.8)' }} viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"left\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z\"></path></svg> </div>}\r\n                    <div style={{ width: '90%' }} className=\"content timeline\">\r\n                        {/* <ReactResizeDetector handleWidth onResize={this.onResize} /> */}\r\n                        <Draggable axis=\"x\" cancel=\".tl-edit\" {...dragHandlers} enableUserSelectHack={true}>\r\n                            <div>\r\n                                {sequence.length !== 0 && sequence[0] !== undefined && <ol ref={el => this.olRef = el} style={{ transform: `translateX(${this.state.timelineTransform}px)` }}>\r\n                                    {sequence.map((insight, i) => {\r\n                                        if (i === 0)\r\n                                            return <li\r\n                                                key={i}\r\n                                                ref={el => this.firstItem = el}\r\n                                                className={InsightTypeTrans[insight.type].toLowerCase()}\r\n                                                style={{ backgroundImage: `linear-gradient(to right, ${ActionColor[actions[i].toString()]} , ${ActionColor[actions[i].toString()]})` }}\r\n                                            // style={{ backgroundImage: `linear-gradient(to right, ${insightColors[sequence[i].type]} , ${insightColors[sequence[i + 1].type]})` }}\r\n                                            >\r\n                                                <TimeLineSlot sequence={sequence} timeValue={timeValue} currentLocale={currentLocale} index={i} insightSpec={insight.spec} captionId={insight.captionId} factType={insight.type} font_min_size={20} {...this.props} passOnClick={this.handleClickDiv}></TimeLineSlot>\r\n                                            </li>\r\n                                        return <li\r\n                                            key={i}\r\n                                            className={InsightTypeTrans[insight.type].toLowerCase()}\r\n                                            style={{ backgroundImage: `linear-gradient(to right, ${ActionColor[actions[i].toString()]} , ${ActionColor[actions[i].toString()]})` }}\r\n                                        // style={{ backgroundImage: `linear-gradient(to right, ${insightColors[sequence[i - 1].type]} , ${insightColors[sequence[i].type]})` }} \r\n                                        >\r\n                                            <TimeLineSlot sequence={sequence} timeValue={timeValue} currentLocale={currentLocale} index={i} insightSpec={insight.spec} captionId={insight.captionId} factType={insight.type} font_min_size={20} {...this.props} passOnClick={this.handleClickDiv}></TimeLineSlot>\r\n                                        </li>\r\n                                    })}\r\n                                    {/* <li\r\n                                        style={{ backgroundImage: `linear-gradient(to right, ${ActionColor[\"-1\"]} , ${ActionColor[\"-1\"]}` }}\r\n                                        style={{ backgroundImage: `linear-gradient(to right, ${insightColors[sequence[sequence.length - 1].type]} , ${insightColors[sequence[sequence.length - 1].type]})` }}\r\n                                    ></li> */}\r\n                                    <li ref={el => this.lastItem = el}></li>\r\n                                </ol>}\r\n                            </div>\r\n                        </Draggable>\r\n                    </div>\r\n                    {sequence.length !== 0 && sequence[0] !== undefined && <div className={`btn-arrow ${this.state.rightOpacity === fullVisable ? 'enabledBtn' : ''}`} style={{ opacity: this.state.rightOpacity }} onClick={() => this.moving('right')}><svg style={{ margin: 'auto', transform: 'scale(0.8)' }} viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"left\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z\"></path></svg></div>}\r\n                </div>\r\n                <div className=\"legends\" style={{ width: '100%' }}>\r\n                    {\r\n                        factTypeIncluced.map((type, index) => {\r\n                            return <div className=\"legend\" key={index}>\r\n                                <span className='dot' style={{ backgroundColor: `${insightColors[InsightTypeTrans[type].toLowerCase()]}` }}></span>\r\n                                <div className='dot_text'>{currentLocale === \"en-US\" ? InsightTypeTrans[type] : InsightTypeZh[type]}</div>\r\n                            </div>\r\n                        })\r\n                    }\r\n                    {\r\n                        actionIncluded.length > 0 ? <div className='legend-space'></div> : null\r\n                    }\r\n                    {\r\n                        actionIncluded.map((action, index) => {\r\n                            return <div className=\"legend\" key={index}>\r\n                                <span className='line' style={{ backgroundColor: `${ActionColor[action.toString()]}` }}></span>\r\n                                <div className='dot_text'>{currentLocale === \"en-US\" ? ActionType[action.toString()] : ActionTypeZh[action.toString()]}</div>\r\n                            </div>\r\n                        })\r\n                    }\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n"],"sourceRoot":""}