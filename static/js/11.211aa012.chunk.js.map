{"version":3,"sources":["axios/ajax.js","axios/index.js","axios/config.js","selector/user.js","pages/Homepage/PannelView/index.js","components/ProgressBar/ProgressBarView.js","axios/api.js","components/Upload/UploadPannel.js","constant/imageUrl.js","constant/config.js","components/Generate/Components/ButtonBox/ButtonBoxView.js","components/Generate/Components/Spining/SpiningView.js","components/Generate/Components/commonSlot/CommonSlotView.js","components/Generate/ToFactsheet/ToFactsheet.js","constant/Color.js","components/Generate/GeneratePannel.js","pages/Homepage/PannelView/PannelView.js"],"names":["ajax","url","data","type","config","axios","get","params","JSON","stringify","post","findInsightUrl","uploadFile","formData","processFile","path","start","end","variable","aggregate","parsingFile","fileurl","generateSequence","file_path","time_col","task","findInsight","file_url","fields","time_field","location","generateSingleInsight","insights","generateRecommendList","previous","current","generateSubsequent","existing_insights","applicationUrl","urlPrefix","uploadDataPrefix","generationUrlPrefix","activitiesPrefix","accountIp","uploadFileUrl","publicPrefix","loginadmintest","loginRedirectUrl","logoutRedirectUrl","authenUrl","accessToken","userImage","checkToken","logout","logoutAuthSystem","users","activitiesApi","uploadData","share","fetch","factScoring","generate","operateState","state","user","isLogin","currentLocale","getUserInfo","Cookies","parse","username","uid","connect","dispatch","updateOperation","userAction","PannelView","ProgressBarView","this","props","percent","isActive","status","showInfo","strokeColor","style","position","top","zIndex","display","React","Component","generatePDF","method","param","Dragger","UploadPannel","originFileOb","errorMessage","initDone","intl","uploadDataToCloud","Promise","reslove","reject","then","response","setState","OperationType","GENERATING","FAILED","options","message_zh","message_en","catch","error","processData","schema","filename","fileURL","fileName","numericalFields","numerical","filter","d","map","field","_that","d3","forEach","i","key","indexOf","parseFloat","UPLOADED","console","log","onUploadChange","info","UPLOADIND","event","updateProgress","total","loaded","file","fileObj","originFileObj","FormData","append","beforeUpload","resolve","size","FILE_LARGE","getPannelClassName","BEFORE_UPLOAD","isShowProgressbar","PannelContentView","generateProgress","ClickToUploadView","className","height","flex","onChange","showUploadList","accept","AliCloud","ConvertForms","name","ConvertType","TIMESEIRES","iconUrl","generateIconUrl","ButtonBoxView","text","onClick","onClickListener","backgroundImage","SpiningView","isSpining","tip","spinning","CommonSlotView","columnCount","form","pdfName","split","FileTypeAndNameView","justifyContent","marginBottom","myClassName","children","padding","href","target","rel","ToFactsheet","isDownloading","download","api","reUpload","reGnerate","editPage","history","push","click","supportedButton","length","button","index","GREEN","YELLOW","BLUE","GRAY","BAR_BACK","BAR","BAR_HIGHTLIGHT","AREA","LINE","BG_ABOVE","BG_BELOW","CONVERT","GeneratePannel","convertingType","generateStory","maxStoryLength","count","max_iteration","timer","setInterval","clearInterval","GENERATED","storyParameter","file_name","max_story_length","fail","clickGenerate","typeForm","originFileUrl","result","setParsedFileData","columns","granularity","originData","timeColumns","timeValues","nextProps","ConvertingArrow","FileNameView","Math","ceil","idx","backgroundColor","Color","visibility","PUBLISHED","GeneratedPannel","Loading","width","marginTop","FACTSHEET","flexDirection","alignItems","fallback"],"mappings":";2cAMe,SAASA,EAAKC,GAAkC,IAA9BC,EAAK,UAAD,6CAAC,GAAGC,EAAK,UAAD,6CAAC,MAAMC,EAAO,UAAD,6CAAC,GACvD,MAAU,QAAPD,EACQE,IAAMC,IAAIL,EAAI,CACjBM,OAAOL,IAGiB,OAAzBM,KAAKC,UAAUL,GACPC,IAAMK,KAAKT,EAAIC,GAEnBG,IAAMK,KAAKT,EAAIC,EAAKE,G,WCQ/BO,EAAiB,sDAIRC,EAAa,SAACC,GAAQ,OAAKb,EAPxB,4CAOwCa,EAAU,OAC9D,CACI,QAAW,CACP,eAAgB,0BAIfC,EAAc,SAACC,EAAMC,EAAOC,EAAKC,EAAUC,GAAS,OAAKnB,EAVpD,gDAWd,CACI,KAAQe,EACR,MAASC,EACT,IAAOC,EACP,SAAYC,EACZ,UAAaC,GAEjB,OACA,CACI,QAAW,CACP,eAAgB,uBAMfC,EAAc,SAACC,GAAO,OAAKrB,EA9BrB,8CAgCf,CACI,KAAQqB,GAEZ,QAKSC,EAAmB,SAACC,EAAWC,EAAUC,GAAI,OAAKzB,EAvCrC,oDAwCtB,CACI,KAAQuB,EACR,WAAcC,EACd,KAAQC,GAEZ,OACA,CACI,QAAW,CACP,eAAgB,uBAKfC,EAAc,SAACC,EAAUC,EAAQC,EAAYC,GAAQ,OAAK9B,EAAKW,EACxE,CACI,SAAYgB,EACZ,OAAUC,EACV,WAAcC,EACd,SAAYC,GAEhB,OACA,CACI,QAAW,CACP,eAAgB,uBAKfC,EAAwB,SAACJ,EAAUC,EAAQC,EAAYC,EAAUE,GAAQ,OAAKhC,EAAKW,EAC5F,CACI,SAAYgB,EACZ,OAAUC,EACV,WAAcC,EACd,SAAYC,EACZ,SAAYE,GAEhB,OACA,CACI,QAAW,CACP,eAAgB,uBAKfC,EAAwB,SAACN,EAAUE,EAAYJ,EAAMS,EAAUC,GAAO,OAAKnC,EAjF3D,wDAkFzB,CACI,SAAY2B,EACZ,WAAcE,EACd,KAAQJ,EACR,SAAYS,EACZ,QAAWC,GAEf,OACA,CACI,QAAW,CACP,eAAgB,uBAKfC,EAAqB,SAACrB,EAAMc,EAAYQ,EAAmBZ,GAAI,OAAKzB,EApGvD,oDAqGtB,CACI,KAAQe,EACR,WAAcc,EACd,kBAAqBQ,EACrB,KAAQZ,GAEZ,OACA,CACI,QAAW,CACP,eAAgB,wB,iCCnI5B,IAIIa,EAAiB,kCAEjBC,EAAiD,kBAN/B,+BAM4D,gBAC9EC,EAAwD,kBALlC,qCAMtBC,EAA2D,kBANrC,qCAOtBC,EAAwD,kBATtC,+BASmE,gBAIrFC,EAAS,mCAWPvC,EAAS,CACXH,IAAK,CAED2C,cAAc,GAAD,OAJE,wBAImB,WAIlCN,eAAgBA,EAEhBO,aAvBmDP,kCAyBnDQ,eAAe,GAAD,OAAKP,EAAS,mBAC5BQ,iBAAiB,GAAD,OAAKJ,EAAS,iDAxBtB,uCAwBwE,uDAA+CL,GAC/HU,kBAAkB,GAAD,OAAKV,EAAc,aACpCW,UAAWN,EACXO,YAAY,GAAD,OAAKX,EAAS,gBACzBY,UAAU,GAAD,OA1BM,wCA0BkB,QACjCC,WAAW,GAAD,OAAKb,EAAS,eAExBc,OAAO,GAAD,OAAKd,EAAS,WACpBe,iBAAiB,GAAD,OA9BD,wCA8ByB,WAExCC,MAAM,GAAD,OAAKhB,EAAS,UACnBiB,cAAc,GAAD,OAAKd,EAAgB,UAElCF,iBAAkBA,EAClBiB,WAAW,GAAD,OAAKjB,EAAgB,WAC/BkB,MAAM,GAAD,OAAKlB,EAAgB,UAC1BmB,MAAM,GAAD,OAAKnB,EAAgB,eAE1BoB,YAAY,GAAD,OAAKnB,EAAmB,SACnCoB,SAAS,GAAD,OAAKpB,EAAmB,eAOzBrC,O,iCC/Df,6JAGa0D,EAAe,SAAAC,GAAK,OAAIA,EAAMC,KAAKF,cACnCG,EAAU,SAAAF,GAAK,OAAIA,EAAMC,KAAKC,SAE9BC,EAAgB,SAAAH,GAAK,OAAIA,EAAMC,KAAKE,eAEpCC,EAAc,SAAAJ,GACvB,OAAOK,IAAQ9D,IAAI,aAAeE,KAAK6D,MAAMD,IAAQ9D,IAAI,aAAeE,KAAK6D,MAAMD,IAAQ9D,IAAI,aAAe,CAC1GgE,SAAU,GACVC,KAAM,K,sDCXd,4CAgBeC,uBAVS,SAACT,GAAK,MAAM,CAChCD,aAAcA,YAAaC,OAGJ,SAAAU,GACvB,MAAO,CACHC,gBAAiB,SAACZ,GAAY,OAAKW,EAASE,IAA2Bb,QAIhEU,CAA6CI,Y,2TCbvCC,EAAe,kHAa/B,OAb+B,mCAEhC,WACI,MAA8BC,KAAKC,MAA3BC,EAAO,EAAPA,QAASC,EAAQ,EAARA,SACjB,OAAQ,uBACJD,QAASA,EACTE,OAAQD,EAAW,SAAW,GAC9BE,UAAU,EACVC,YAAY,UACZC,MAAO,CACHC,SAAU,WAAYC,IAAK,QAASC,OAAQ,OAC5CC,QAASR,EAAW,QAAU,cAEzC,EAb+B,CAASS,IAAMC,W,oCCwG5C,SAASC,EAAY1F,GACxB,OAAOG,IAAM,CACTwF,OAAQ,OACR5F,IAAI,eACJ6F,MAAO,GACP5F,KAAMA,I,sBCrGN6F,G,OAAO,IAAPA,SAEaC,EAAY,iKAsI5B,OAtI4B,oCAC7BjC,MAAQ,CACJkC,aAAc,GACdnC,aAAc,EAAKiB,MAAMjB,aACzBoC,aAAc,EAAKnB,MAAMoB,UAAY,EAAKpB,MAAMqB,KAAK9F,IAAI,kBAC5D,EAED+F,kBAAoB,SAACxF,GACjB,OAAO,IAAIyF,SAAQ,SAACC,EAASC,GACzB5F,YAAWC,GAAU4F,MAAK,SAAAC,GAGlB,GADJ,EAAKC,SAAS,CAAE7C,aAAc8C,IAAcC,aAChB,UAApBH,EAASxB,OAAoB,CAC7B,IAAMkB,EAAS,EAAKrB,MAAdqB,KAMN,OALA,EAAKO,SAAS,CACV7C,aAAc8C,IAAcE,OAC5BZ,aAA6C,UAA/BE,EAAKW,QAAQ7C,cAA4BwC,EAASM,WAAaN,EAASO,aAE1FT,IACO,KAEXD,EAAQG,MAEbQ,OAAM,SAAAC,GACL,EAAKR,SAAS,CACV7C,aAAc8C,IAAcE,OAC5BZ,aAAc,EAAKnB,MAAMoB,UAAY,EAAKpB,MAAMqB,KAAK9F,IAAI,mBAE7DkG,WAsBX,EAEDY,YAAc,SAACV,GACX,GAAKA,EAASxG,KAAKmH,QAAWX,EAASxG,KAAKyB,UAAa+E,EAASxG,KAAKoH,SAAvE,CAIA,IAAID,EAASX,EAASxG,KAAKmH,OACvBE,EAAUb,EAASxG,KAAKyB,SACxB6F,EAAWd,EAASxG,KAAKoH,SACzBG,EAAkB,GAClBC,EAAYL,EAAOM,QAAO,SAAAC,GAAC,MAAe,cAAXA,EAAEzH,QACrCsH,EAAkBC,EAAUG,KAAI,SAAAD,GAAC,OAAIA,EAAEE,SACvC,IAAIC,EAAK,eACTC,IAAOT,GACFd,MAAK,SAAUvG,GACZA,EAAK+H,SAAQ,SAACL,EAAGM,GACb,IAAK,IAAIC,KAAOP,GAC0B,IAAlCH,EAAgBW,QAAQD,KACxBP,EAAEO,GAAOE,WAAWT,EAAEO,QAIlCJ,EAAMhD,MAAMtB,WAAW+D,EAAUH,EAAQnH,EAAKqH,GAC9CQ,EAAMhD,MAAML,gBAAgBkC,IAAc0B,aAC3CpB,OAAM,SAAUC,GACfoB,QAAQC,IAAIrB,WAtBhB,EAAKpC,MAAML,gBAAgBkC,IAAc0B,WAwBhD,EAEDG,eAAiB,SAACC,GAWd,GATA,EAAK/B,SAAS,CACV7C,aAAc8C,IAAc+B,YAE5BD,EAAKE,OACL,EAAK7D,MAAM8D,eAAeH,EAAKE,MAAME,MAAQJ,EAAKE,MAAME,MAAQJ,EAAKE,MAAMG,QAKhE,cADIL,EAAKM,KAAhB9D,OACoB,CAExB,IAAI+D,EAAUP,EAAKM,KAAKE,cACpBrI,EAAW,IAAIsI,SACnBtI,EAASuI,OAAO,OAAQH,GAExB,EAAK5C,kBAAkBxF,GAElB4F,MAAK,SAACC,GAAQ,OAAK,EAAKU,YAAYV,QAEhD,EACD2C,aAAe,SAACX,GACZ,OAAO,IAAIpC,SAAQ,SAACgD,EAAS9C,GACzB,GAAIkC,EAAKa,MAAQ,QACb,OAAOD,GAAQ,GAEf,EAAK3C,SAAS,CACV7C,aAAc8C,IAAc4C,aAEhChD,GAAO,OAGlB,EAEDiD,mBAAqB,WAEjB,OADyB,EAAK1F,MAAtBD,cAEJ,KAAK8C,IAAc8C,cACf,MAAO,mCACX,KAAK9C,IAAc0B,SACf,MAAO,oCAEX,QACI,MAAO,KAElB,EAEDqB,kBAAoB,WAChB,IAAQ7F,EAAiB,EAAKC,MAAtBD,aACR,OAAIA,IAAiB8C,IAAc+B,WAAa7E,IAAiB8C,IAAcC,YAIlF,EAmFA,OAnFA,mCAGD,WACI,IAgBI+C,EAhBJ,EAA6C9E,KAAKC,MAA1CqB,EAAI,EAAJA,KAAMD,EAAQ,EAARA,SAAU0D,EAAgB,EAAhBA,iBAOlBC,EAAoB,WACtB,OACI,yBAAKC,UAAU,iBACX,8BACA,2BAAG,IAAE5D,GAAYC,EAAK9F,IAAI,sBAMtC,OAhByBwE,KAAKf,MAAtBD,cAiBJ,KAAK8C,IAAc8C,cACfE,EAAoB,oCAChB,yBAAKG,UAAU,gBACX,yBAAKA,UAAU,kBAEnB,yBAAKA,UAAU,cACX,yBAAKA,UAAU,aACX,8BACC5D,GAAYC,EAAK9F,IAAI,oBAE1B,8BAAO6F,GAAYC,EAAK9F,IAAI,2BAA2B,OAG/D,MACJ,KAAKsG,IAAc+B,UACfiB,EAAoB,yBAAKG,UAAU,aAC/B,yBAAKA,UAAU,gBACf,8BAAO5D,GAAYC,EAAK9F,IAAI,mBAC5B,yBAAKyJ,UAAU,OAAM,QAEzB,MACJ,KAAKnD,IAAcE,OACf8C,EAAoB,oCAChB,yBAAKG,UAAU,kBACX,yBAAKA,UAAU,eACf,uBAAGA,UAAU,YAAYjF,KAAKf,MAAMmC,eAExC,kBAAC4D,EAAiB,OAEtB,MACJ,KAAKlD,IAAc4C,WACfI,EAAoB,oCAChB,yBAAKG,UAAU,iBACX,8BACA,8BAAO5D,GAAYC,EAAK9F,IAAI,qBAEhC,kBAACwJ,EAAiB,OAO9B,OACI,yBAAKC,UAAWjF,KAAK2E,qBAAsBpE,MAAO,CAAEC,SAAU,aAC1D,kBAAC,EAAe,CAACN,QAAS6E,EAAkB5E,SAAUH,KAAK6E,sBAC3D,yBAAKtE,MAAO,CAAE2E,OAAQ,QAASC,KAAM,IACjC,kBAAClE,EAAO,CACJsD,aAAcvE,KAAKuE,aACnBa,SAAUpF,KAAK2D,eACf0B,gBAAgB,EAChBC,OAAO,eACP,yBAAKL,UAAU,iBAEPH,UAO3B,EAzN4B,CAASlE,IAAMC,W,0BCZjC0E,EADE,gECoBFC,EAjBI,CACf,CACIC,KAAMC,IAAYC,WAClBC,QAAQ,GAAD,OAAKL,EAAQ,8BACpBM,gBAAgB,GAAD,OAAKN,EAAQ,sCCFfO,G,OAAa,kHAS7B,OAT6B,mCAE9B,WAAU,IAAD,OACL,EAA0B9F,KAAKC,MAAvB2F,EAAO,EAAPA,QAASG,EAAI,EAAJA,KACjB,OAAO,yBAAKd,UAAU,aAAae,QAAS,kBAAM,EAAK/F,MAAMgG,oBACzD,yBAAK1F,MAAO,CAAE2F,gBAAgB,OAAD,OAASN,EAAO,QAC7C,2BAAIG,QAGX,EAT6B,CAASnF,IAAMC,YCA5BsF,G,OAAW,kHAO3B,OAP2B,mCAE5B,WACI,MAAsCnG,KAAKC,MAAnCmG,EAAS,EAATA,UAAW/E,EAAQ,EAARA,SAAUC,EAAI,EAAJA,KAC7B,OAAO,oCACH,uBAAM+E,IAAKhF,GAAYC,EAAK9F,IAAI,eAAgB8K,SAAUF,SAEjE,EAP2B,CAASxF,IAAMC,YCG1B0F,G,cAAc,kHAyB9B,OAzB8B,mCAC/B,WACI,MAAmEvG,KAAKC,MAAhEyC,EAAQ,EAARA,SAAUrB,EAAQ,EAARA,SAAUC,EAAI,EAAJA,KAAMkF,EAAW,EAAXA,YAAaC,EAAI,EAAJA,KAAML,EAAS,EAATA,UACjDM,EAAUhE,GAAYA,EAASiE,MAAM,QAAQ,GAE3CC,EAAsB,WACxB,OAAO,yBAAK3B,UAAU,sBAAsB1E,MAAO,CAAEsG,eAAgBT,EAAY,aAAe,WAC5F,yBAAKnB,UAAU,kBACf,0BAAM1E,MAAO,CAAEuG,aAAc,QAAoB,OAATL,EAAgB,GAAE,UAAMC,EAAO,WAI/E,OAAO,yBAAKzB,UAAWjF,KAAKC,MAAM8G,YAAW,6BAAyB/G,KAAKC,MAAM8G,aAAgB,sBAC7F,8BAAQ1F,GAAYC,EAAK9F,IAAa,OAATiL,EAAgB,iBAAmB,iBAChE,kBAACG,EAAmB,MACpB,yBAAK3B,UAAU,cAAc1E,MAAO,CAAEiG,gBAClC,yBAAKvB,UAAU,gBACX,kBAAC,EAAW,eAACmB,UAAWA,GAAepG,KAAKC,SAG5CD,KAAKC,MAAM+G,UAGnB,8BAAQ3F,GAAYC,EAAK9F,IAAI,SAAS,uBAAG+E,MAAO,CAAE0G,QAAS,WAAaC,KAAK,2BAA2BC,OAAO,SAASC,IAAI,uBAAsB,sBAAoB/F,GAAYC,EAAK9F,IAAI,uBAElM,EAzB8B,CAASoF,IAAMC,YCG7BwG,G,OAAW,iKA4C3B,OA5C2B,oCAE5BpI,MAAQ,CACJqI,eAAe,GAClB,EAEDC,SAAW,WACP,EAAK1F,SAAS,CACVyF,eAAe,IAMnBE,EAHW,IAGW7F,MAAK,gBAC9B,EAED8F,SAAW,WACP,EAAKxH,MAAML,gBAAgBkC,IAAc8C,gBAC5C,EACD8C,UAAY,WACR,EAAKzH,MAAMyH,UAAUlC,EAAa,KACrC,EACDmC,SAAW,WACP,EAAK1H,MAAM2H,QAAQC,KAAK,oBAC3B,EACDC,MAAQ,SAAC/B,GACL,MAA2B,EAAK9F,MAAxBqB,EAAI,EAAJA,KAAMD,EAAQ,EAARA,SACd,OAAQ0E,GACJ,KAAK1E,GAAYC,EAAK9F,IAAI,UACtB,EAAKiM,WACL,MACJ,KAAKpG,GAAYC,EAAK9F,IAAI,aACtB,EAAKkM,YACL,MACJ,KAAKrG,GAAYC,EAAK9F,IAAI,YACtB,EAAK+L,WACL,MACJ,KAAKlG,GAAYC,EAAK9F,IAAI,QACtB,EAAKmM,aAKhB,EAiCA,OAjCA,mCAED,WAAU,IAAD,OACL,EAAqC3H,KAAKC,MAAlCqB,EAAI,EAAJA,KAAMD,EAAQ,EAARA,SAAUqB,EAAQ,EAARA,SAChB4E,EAAkBtH,KAAKf,MAAvBqI,cAEFS,EAAkB,CACpB,CACInC,QAAQ,GAAD,OAAKL,EAAQ,qBACpBQ,KAAM1E,GAAYC,EAAK9F,IAAI,WAE/B,CACIoK,QAAQ,GAAD,OAAKL,EAAQ,4BACpBQ,KAAM1E,GAAYC,EAAK9F,IAAI,cAE/B,CACIoK,QAAQ,GAAD,OAAKL,EAAQ,0BACpBQ,KAAM1E,GAAYC,EAAK9F,IAAI,aAE/B,CACIoK,QAAQ,GAAD,OAAKL,EAAQ,sBACpBQ,KAAM1E,GAAYC,EAAK9F,IAAI,UAGnC,OACI,kBAAC,EAAc,eAACuL,YAAa,cAAerE,SAAUA,EAAU0D,UAAWkB,EAAed,YAAauB,EAAgBC,QAAYhI,KAAKC,OAEhI8H,EAAgBhF,KAAI,SAACkF,EAAQC,GACzB,OAAO,kBAAC,EAAa,CAAC7E,IAAK,SAAW6E,EAAOtC,QAASqC,EAAOrC,QAASG,KAAMkC,EAAOlC,KAAME,gBAAiB,kBAAM,EAAK6B,MAAMG,EAAOlC,iBAKrJ,EA7E2B,CAASnF,IAAMC,YCXhC,GACXsH,MAAO,oBACPC,OAAQ,SACRC,KAAM,UACNC,KAAM,YACNC,SAAU,UACVC,IAAK,UACLC,eAAgB,UAChBC,KAAM,UACNC,KAAM,UACNC,SAAU,UACVC,SAAU,UACVC,QAAS,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,Y,oBCXrE,kmGAAA1F,GAAA,wBAAAA,EAAA,sBAAAA,GAAA,iBAAAA,GAAA,ssDAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,4bAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,yhBAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,qGAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,sQAW0C,IAGrB2F,EAAc,iKAwI9B,OAxI8B,oCAE/B9J,MAAQ,CACJD,aAAc,EAAKiB,MAAMjB,aACzBgK,eAAgBxD,EAAa,IAChC,EASDzG,SAAW,SAACxC,GACR,OAAO,IAAIiF,QAAO,uCAAC,WAAOgD,EAAS9C,GAAM,iFA0BrC,OAzBIgB,EAAW,EAAKzC,MAAMyC,SAC1B,EAAKzC,MAAMgJ,cAAc,GAAI,GAAI,IACjC,EAAKhJ,MAAM8D,eAAe,EAAK9D,MAAMiJ,eAAgB,EAAKjJ,MAAMiJ,gBAG5DC,EADAC,EAAgB,EAGhBC,EAAQC,aAAY,WACN,IAAVH,IACAI,cAAcF,GACd,EAAKxH,SAAS,CACV7C,aAAc8C,IAAc0H,YAEhC,EAAKvJ,MAAM2H,QAAQC,KAAK,UAE5BsB,IACA,EAAKlJ,MAAM8D,eAAeqF,EAAeD,EAAQ,EAAI,EAAIA,KAC1D,MAEKM,EAAmB,EAAKxJ,MAAxBwJ,eAEG,CACPC,UAAWhH,EACXiH,iBAAkBF,EAAeP,gBAErC,SACuB5M,YAAYC,GAAQ,OAArCqF,EAAQ,OACd2H,cAAcF,GACVzH,EAASxG,KAAKwO,OACd,EAAK/H,SAAS,CACV7C,aAAc8C,IAAcE,OAC5BZ,aAAcQ,EAASxG,KAAKwO,OAEhClI,KAEAE,EAASxG,KAAKiH,QACd,EAAKR,SAAS,CACV7C,aAAc8C,IAAcE,OAC5BZ,aAAcQ,EAASxG,KAAKiH,QAEhCX,KAEJ,EAAKzB,MAAM8D,eAAeqF,EAAe,GACzC,EAAKvH,SAAS,CACV7C,aAAc8C,IAAc0H,YAEhChF,EAAQ5C,GAAS,4CACpB,qDAhDiB,KAiDrB,EAED+C,mBAAqB,WAEjB,OADyB,EAAK1F,MAAtBD,cAEJ,KAAK8C,IAAc0B,SACf,MAAO,oCACX,KAAK1B,IAAcC,WACnB,KAAKD,IAAc0H,UACf,MAAO,kCACX,QACI,MAAO,KAElB,EAED3E,kBAAoB,WAEhB,OADyB,EAAK5F,MAAtBD,eACa8C,IAAcC,YAItC,EAED8H,cAAgB,SAACC,GACb,EAAKjI,SAAS,CACVmH,eAAgBc,EAChB9K,aAAc8C,IAAcC,aAErB+H,EAASrE,KAEpB,EAAK1G,SAAS,EAAKkB,MAAM8J,eAAepI,MAAK,SAAAC,GAEzC,IAAIoI,EAAOpI,EAASxG,KAEpB,EAAK6E,MAAMgK,kBAAkBD,EAAOE,QACPF,EAAOG,YACP,CAAC,EAAE,EAAKlK,MAAMmK,WAAWpC,OAAO,GAChCgC,EAAOK,YACPL,EAAOM,YAEpC,EAAKrK,MAAM2H,QAAQC,KAAK,aAgC/B,EA+GA,OA/GA,6DAjID,SAAiC0C,GACzBA,EAAUvL,eAAiBgB,KAAKC,MAAMjB,cACtCgB,KAAK6B,SAAS,CACV7C,aAAcuL,EAAUvL,iBAGnC,oBA6HD,WAAU,IAyBF8F,EAzBC,OACL,EAA6C9E,KAAKC,MAA1CqB,EAAI,EAAJA,KAAMD,EAAQ,EAARA,SAAU0D,EAAgB,EAAhBA,iBACxB,EAAyC/E,KAAKf,MAAtCD,EAAY,EAAZA,aAAcgK,EAAc,EAAdA,eAGhBwB,EAAkB,SAAH,GAA0B,IAApBxL,EAAY,EAAZA,aACvB,OAAQ,yBAAKiG,UAAU,gBACnB,2BAAG,IAAE,EAAKhF,MAAM8E,iBAAmB,KACnC,yBAAKE,UAAU,cAEXjG,IAAiB8C,IAAc0H,UAC3B,2BAAG,IAAEnI,GAAYC,EAAK9F,IAAI,YAE1B,2BAAG,IAAE6F,GAAYC,EAAK9F,IAAI,gBAKpCiP,EAAe,SAAH,GAAsB,IAAhB/H,EAAQ,EAARA,SACpB,OAAO,yBAAKuC,UAAU,gBAClB,yBAAKA,UAAU,iBACf,0BAAMA,UAAU,YAAYvC,KAKpC,OAAQ1D,GACJ,KAAK8C,IAAc0B,SACfsB,EAAoB,oCAChB,yBAAKvE,MAAO,CAAE2E,OAAQ,QAASC,KAAM,IACjC,yBAAKF,UAAU,cACX,kBAACwF,EAAY,CAAC/H,SAAU1C,KAAKC,MAAMyC,aAG3C,yBAAKuC,UAAU,kBAAkB1E,MAAO,CAAEiG,YAAakE,KAAKC,KAAKnF,EAAawC,OAAS,KAE/ExC,EAAazC,KAAI,SAAC1H,EAAMuP,GACpB,OAAO,yBAAK3F,UAAU,cAClB5B,IAAKuH,EACLrK,MAAO,CAAE2E,OAAgC,IAAxBM,EAAawC,OAAe,OAAS,MAAO6C,gBAAiBC,EAAMhC,QAAQ8B,IAC5F5E,QAAS,kBAAM,EAAK6D,cAAcxO,KAClC,yBAAK4J,UAAU,OACX1E,MAAO,CAAE2F,gBAAgB,OAAD,OAAS7K,EAAKuK,QAAO,QAEjD,8BAAOvE,GAAYC,EAAK9F,IAAI,KAAD,OAAMH,EAAKoK,YAKtB,IAAxBD,EAAawC,QAAgBxC,EAAawC,OAAS,IAAM,EACrD,yBAAKzH,MAAO,CAAE2E,OAAQ,MAAO6F,WAAY,OAAQF,gBAAiB,iBAChE,OAIlB,MACJ,KAAK/I,IAAcC,WACf+C,EAAoB,yBAAKvE,MAAO,CAAE2E,OAAQ,QAASC,KAAM,IACrD,yBAAKF,UAAU,cACX,yBAAK1E,MAAO,CAAEI,QAAS,SACnB,kBAAC8J,EAAY,CAAC/H,SAAU1C,KAAKC,MAAMyC,WACnC,yBAAKuC,UAAU,YACX,kBAACuF,EAAe,eAACxL,aAAcA,GAAkBgB,KAAKC,QACtD,yBAAKgF,UAAU,gBACX,yBAAKA,UAAU,eACX1E,MAAO,CAAE2F,gBAAgB,OAAD,OAAS8C,EAAenD,gBAAe,QAEnE,0BAAMZ,UAAU,YAAY5D,GAAYC,EAAK9F,IAAI,KAAD,OAAMwN,EAAevD,aAMzF,MACJ,KAAK3D,IAAckJ,UACf,IAMIC,EANEC,EAAU,WACZ,OAAQ,yBAAK3K,MAAO,CAAE4K,MAAO,OAAQjG,OAAQ,OAAQvE,QAAS,OAAQkG,eAAgB,SAAUuE,UAAW,SACvG,8BAKR,OAAQpC,EAAevD,MACnB,KAAKC,IAAY2F,UACbJ,EAAkB,kBAAC,EAAW,eAACvD,UAAW1H,KAAK6J,eAAoB7J,KAAKC,QAMhF6E,EAAoB,yBAAKvE,MAAO,CAAE2E,OAAQ,QAASC,KAAM,IACrD,yBAAKF,UAAU,cACX,yBAAK1E,MAAO,CAAEI,QAAS,OAAQ2K,cAAe,SAAUC,WAAY,SAAUrG,OAAQ,SAClF,kBAAC,WAAQ,CAACsG,SAAU,kBAACN,EAAO,OACvBD,MASzB,OAAO,yBAAKhG,UAAWjF,KAAK2E,sBACxB,kBAAC,EAAe,CAACzE,QAAS6E,EAAkB5E,SAAUH,KAAK6E,sBAEvDC,OAGX,EAvP8B,CAASlE,IAAMC,WCP7Bf,G,OAAU,kHA4B1B,OA5B0B,mCAC3B,WACI,IACIA,EADJ,EAAyCE,KAAKC,MAAtCqB,EAAI,EAAJA,KAAMD,EAAQ,EAARA,SAAUrC,EAAY,EAAZA,aAExB,OAAQA,GAEJ,KAAK8C,IAAc8C,cACnB,KAAK9C,IAAc+B,UACnB,KAAK/B,IAAcE,OACnB,KAAKF,IAAc4C,WACf5E,EAAa,kBAAC,EAAY,eAACd,aAAcA,GAAkBgB,KAAKC,QAChE,MAEJ,KAAK6B,IAAc0B,SACnB,KAAK1B,IAAcC,WACnB,KAAKD,IAAckJ,UACflL,EAAa,kBAAC,EAAc,eAACd,aAAcA,GAAkBgB,KAAKC,QAM1E,OAAO,6BACH,yBAAKgF,UAAU,gBAAe,8BAAW,IAAC,8BAAO5D,GAAYC,EAAK9F,IAAI,uBAElEsE,OAGX,EA5B0B,CAASe","file":"static/js/11.211aa012.chunk.js","sourcesContent":["/*\r\n发送异步ajax请求的模块\r\n封装axios库\r\n函数的返回值是promise对象\r\n */\r\nimport axios from 'axios'\r\nexport default function ajax(url,data={},type='GET',config={}){\r\n    if(type==='GET'){\r\n        return axios.get(url,{\r\n            params:data\r\n        });\r\n    }else{\r\n        if(JSON.stringify(config)==='{}'){\r\n            return axios.post(url,data);\r\n        }\r\n        return axios.post(url,data,config);\r\n    }\r\n}","/*\r\n包含应用中所有接口请求函数的模块\r\n每个函数的返回值都是promise\r\n */\r\nimport ajax from './ajax'\r\nimport config from './config';\r\n// let uploadUrl = 'http://localhost:6038/upload'\r\n// let parseFileUrl = 'http://localhost:6038/metadata'\r\n// let generateSequenceUrl = 'http://localhost:6040/generate/story'\r\n// let findInsightUrl = 'http://localhost:6040/generate/insight'\r\n// let fileProcess = 'http://localhost:6038/preprocess'\r\n// let genertateRecommendList = 'http://localhost:6040/generate/recommend'\r\n//zerotier:172.30.249.157\r\n// let uploadUrl = 'http://172.30.249.157:6038/upload'\r\n// let parseFileUrl = 'http://172.30.249.157:6038/metadata'\r\n// let generateSequenceUrl = 'http://172.30.249.157:6040/generate/story'\r\n// let findInsightUrl = 'http://172.30.249.157:6040/generate/insight'\r\n// let fileProcess = 'http://172.30.249.157:6038/preprocess'\r\n// let genertateRecommendList = 'http://172.30.249.157:6040/generate/recommend'\r\n// vasta-api.idvxlab.com\r\nlet uploadUrl = 'https://vasta-api.idvxlab.com:8008/upload'\r\nlet parseFileUrl = 'https://vasta-api.idvxlab.com:8008/metadata'\r\nlet generateSequenceUrl = 'https://vasta-api.idvxlab.com:8008/generate/story'\r\nlet findInsightUrl = 'https://vasta-api.idvxlab.com:8008/generate/insight'\r\nlet fileProcess = 'https://vasta-api.idvxlab.com:8008/preprocess'\r\nlet genertateRecommendList = 'https://vasta-api.idvxlab.com:8008/generate/recommend'\r\n//upload file\r\nexport const uploadFile = (formData) => ajax(uploadUrl, formData, 'POST',\r\n    {\r\n        \"headers\": {\r\n            'Content-Type': 'multipart/form-data' //application/json; charset=utf-8\r\n        },\r\n    });\r\n\r\nexport const processFile = (path, start, end, variable, aggregate) => ajax(fileProcess,\r\n    {\r\n        'path': path,\r\n        'start': start,\r\n        'end': end,\r\n        'variable': variable,\r\n        'aggregate': aggregate\r\n    },\r\n    'POST',\r\n    {\r\n        \"headers\": {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    }\r\n);\r\n\r\n//analysis file's columns、time column、granularity and so on\r\nexport const parsingFile = (fileurl) => ajax(\r\n    parseFileUrl,\r\n    {\r\n        'path': fileurl\r\n    },\r\n    'GET'\r\n);\r\n\r\n\r\n//------------generate sequence-----------\r\nexport const generateSequence = (file_path, time_col, task) => ajax(generateSequenceUrl,\r\n    {\r\n        'path': file_path,\r\n        'time_field': time_col,\r\n        'task': task\r\n    },\r\n    'POST',\r\n    {\r\n        \"headers\": {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    }\r\n);\r\n//---find insights-------\r\nexport const findInsight = (file_url, fields, time_field, location) => ajax(findInsightUrl,\r\n    {\r\n        'file_url': file_url,\r\n        'fields': fields,\r\n        'time_field': time_field,\r\n        'location': location\r\n    },\r\n    'POST',\r\n    {\r\n        \"headers\": {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    }\r\n);\r\n//-------generate single insight-------\r\nexport const generateSingleInsight = (file_url, fields, time_field, location, insights) => ajax(findInsightUrl,\r\n    {\r\n        'file_url': file_url,\r\n        'fields': fields,\r\n        'time_field': time_field,\r\n        'location': location,\r\n        'insights': insights\r\n    },\r\n    'POST',\r\n    {\r\n        \"headers\": {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    }\r\n);\r\n//------request recommendList-------\r\nexport const generateRecommendList = (file_url, time_field, task, previous, current) => ajax(genertateRecommendList,\r\n    {\r\n        'file_url': file_url,\r\n        'time_field': time_field,\r\n        'task': task,\r\n        'previous': previous,\r\n        'current': current\r\n    },\r\n    'POST',\r\n    {\r\n        \"headers\": {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    }\r\n);\r\n//------generate update story-------\r\nexport const generateSubsequent = (path, time_field, existing_insights, task) => ajax(generateSequenceUrl,\r\n    {\r\n        'path': path,\r\n        'time_field': time_field,\r\n        'existing_insights': existing_insights,\r\n        'task': task\r\n    },\r\n    'POST',\r\n    {\r\n        \"headers\": {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    }\r\n);","//let calliopeService = 'service.datacalliope.com';\nlet calliopeService = 'calliope-service.idvxlab.com';\n//let calliopeLiteService = 'calliope-service.idvxlab.com:8004';\nlet calliopeLiteService = 'calliope-service.idvxlab.com:8002';\n// let applicationUrl='https://datacalliope.com';\nlet applicationUrl = 'http://calliope-dev.idvxlab.com';\n\nlet urlPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeService}:8002/api/v1` : 'http://localhost:7001/api/v1';\nlet uploadDataPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeLiteService}` : 'http://localhost:6038';//todo  7001\nlet generationUrlPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeLiteService}` : 'http://localhost:6040';//todo  7001\nlet activitiesPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeService}:8002/log/v1` : 'http://localhost:7001/log/v1';\nlet publicPrefix = process.env.NODE_ENV === 'production' ? applicationUrl : 'http://localhost:3000';\n//let client_id = '033338f2-02a8-44d4-8d54-5173b4a864f9';\nlet client_id = '6dcd0f8b-6990-4d69-9018-29b3351aa6ff';\nlet accountIp = `https://account.datacalliope.com`\nlet logoutRedirectUrlIp = `https://service.datacalliope.com:8001`\n\n\n//sequence API\n// let generateSequencePrefic='http://192.168.1.82:6040/'\n// let fileServerPrefix='http://172.30.138.189:6038'\n// let generateServerPrefix='http://172.30.138.189:6040'\n// setupPoxy.js进行跨域配置\n// let fileServerPrefix='http://172.30.138.189:6038'\nlet fileServerPrefix = 'http://localhost:6038'\nconst config = {\n    url: {\n        //sequence\n        uploadFileUrl: `${fileServerPrefix}/upload`,\n        // generateSequenceUrl:`${generateServerPrefix}/generate/story`,\n\n\n        applicationUrl: applicationUrl,\n        //share\n        publicPrefix: publicPrefix,\n        //login\n        loginadmintest: `${urlPrefix}/loginadmintest`,\n        loginRedirectUrl: `${accountIp}/#/login?response_type=code&client_id=${client_id}&grant_type=authorization_code&redirect_uri=${applicationUrl}`,\n        logoutRedirectUrl: `${applicationUrl}/#/logout`,\n        authenUrl: accountIp,\n        accessToken: `${urlPrefix}/accesstoken`,\n        userImage: `${logoutRedirectUrlIp}/img`,\n        checkToken: `${urlPrefix}/checktoken`,\n        //logout\n        logout: `${urlPrefix}/logout`,\n        logoutAuthSystem: `${logoutRedirectUrlIp}/logout`,\n        //activities\n        users: `${urlPrefix}/users`,\n        activitiesApi: `${activitiesPrefix}/users`,\n        //upload\n        uploadDataPrefix: uploadDataPrefix,\n        uploadData: `${uploadDataPrefix}/upload`,\n        share: `${uploadDataPrefix}/share`,\n        fetch: `${uploadDataPrefix}/data/share`,\n        //story generation\n        factScoring: `${generationUrlPrefix}/fact`,\n        generate: `${generationUrlPrefix}/generate`,\n\n\n        //sequence:\n        // generateSequence:`${generateSequencePrefic}/generate/story`\n    }\n}\nexport default config","//import { createSelector } from 'reselect';\nimport Cookies from 'js-cookie';\n\nexport const operateState = state => state.user.operateState;\nexport const isLogin = state => state.user.isLogin;\nexport const convertType = state => state.user.convertType;\nexport const currentLocale = state => state.user.currentLocale;\n\nexport const getUserInfo = state => {\n    return Cookies.get(\"userInfo\") && JSON.parse(Cookies.get(\"userInfo\")) ? JSON.parse(Cookies.get(\"userInfo\")) : {\n        username: \"\",\n        uid: -1\n    }\n}\n\n","import { connect } from 'react-redux';\nimport { operateState } from '@/selector/user';\nimport * as userAction from '@/action/userAction';\n\nimport PannelView from './PannelView';\n\nconst mapStateToProps = (state) => ({\n    operateState: operateState(state)\n})\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        updateOperation: (operateState) => dispatch(userAction.updateOperation(operateState)),\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PannelView);\n","import React from 'react';\nimport { Progress } from \"antd\";\n\nexport default class ProgressBarView extends React.Component {\n\n    render() {\n        const { percent, isActive } = this.props\n        return (<Progress\n            percent={percent}\n            status={isActive ? \"active\" : \"\"}\n            showInfo={false}\n            strokeColor=\"#EB6331\"\n            style={{\n                position: \"absolute\", top: \"-10px\", zIndex: \"9999\",\n                display: isActive ? \"block\" : \"none\"\n            }} />)\n    }\n}","import config from '@/axios/config';\nimport axios from 'axios';\n\nexport async function uploadData(formData) {\n    return new Promise((reslove, reject) => {\n        axios({\n            method: \"post\",\n            url: `${config.url.uploadData}`,\n            config: {\n                \"headers\": {\n                    'Content-Type': 'multipart/form-data' //application/json; charset=utf-8\n                },\n            },\n            data: formData\n        }).then((response) => {\n            if (response.status >= 400) {\n                reject();\n            } else if (response.status === 200 || response.status === 201 || response.status === 204) {\n                reslove(response.data);\n            } else {\n                reject();\n            }\n        }).catch(error => {\n            reject();\n            //  message.error('error message');\n        })\n    })\n}\n\n\nexport function generate(url, data) {\n    return axios({\n        method: \"post\",\n        url: url,\n        config: {\n            \"headers\": {\n                'Content-Type': 'application/json; charset=utf-8'\n            },\n        },\n        data: data\n    })\n}\n\n\n\nexport function factScoring(filename, fact, method) {\n    return axios({\n        \"method\": \"POST\",\n        \"url\": config.url.factScoring,\n        \"headers\": {\n            \"Content-Type\": \"application/json; charset=utf-8\"\n        },\n        \"data\": {\n            \"file_name\": filename,\n            \"fact\": fact,\n            \"method\": method,\n        }\n    })\n}\n\nexport async function shareStory(jsonstring) {\n    return new Promise((reslove, reject) => {\n        axios({\n            method: \"post\",\n            url: `${config.url.share}`,\n            config: {\n                \"headers\": {\n                    'Content-Type': 'application/json; charset=utf-8'\n                },\n            },\n            data: {\n                \"share_json\": jsonstring\n            }\n        }).then((response) => {\n            if (response.status >= 400) {\n                reject();\n            } else if (response.status === 200 || response.status === 201 || response.status === 204) {\n                reslove(response.data);\n            } else {\n                reject();\n            }\n        }).catch(error => {\n            reject();\n            //  message.error('error message');\n        })\n    })\n}\n\nexport async function fetchStory(id) {\n    return axios({\n        method: \"get\",\n        \"url\": `${config.url.fetch}/${id}.json`,\n        config: {\n            \"headers\": {\n                'Content-Type': 'application/json; charset=utf-8'\n            },\n        }\n    })\n}\n/*****\n *技术栈：\n ssr(后端渲染)，koa(koa-views)：模板渲染，渲染出要生成pdf的页面)\n node.js 生成pdf插件 puppeteer：将渲染的页面生成PDF\n koa-send：将生成的PDF返回给前端页面下载 \n * \n data是后端用于渲染页面的数据\n */\nexport function generatePDF(data) {\n    return axios({\n        method: 'post',\n        url: `/generatePDF`,\n        param: {},\n        data: data\n    })\n}\n","import React from 'react';\nimport { Upload } from 'antd';\nimport ProgressBarView from '@/components/ProgressBar/ProgressBarView'\nimport OperationType from '@/constant/OperationType'\nimport config from '@/axios/config';\nimport * as api from '@/axios/api';\nimport * as d3 from 'd3';\nimport { uploadFile } from '../../axios';\n\nimport \"./UploadPannel.less\";\n\nconst { Dragger } = Upload;\n\nexport default class UploadPannel extends React.Component {\n    state = {\n        originFileOb: {},\n        operateState: this.props.operateState,\n        errorMessage: this.props.initDone && this.props.intl.get(\"upload failed\")\n    }\n\n    uploadDataToCloud = (formData) => {\n        return new Promise((reslove, reject) => {\n            uploadFile(formData).then(response => {\n               \n                this.setState({ operateState: OperationType.GENERATING }); //加快页面交互的响应\n                    if (response.status === 'error') {\n                        let { intl } = this.props\n                        this.setState({\n                            operateState: OperationType.FAILED,\n                            errorMessage: intl.options.currentLocale === 'zh-CN' ? response.message_zh : response.message_en\n                        })\n                        reject();\n                        return null;\n                    }\n                    reslove(response);\n                \n            }).catch(error => {\n                this.setState({\n                    operateState: OperationType.FAILED,\n                    errorMessage: this.props.initDone && this.props.intl.get(\"upload failed\")\n                })\n                reject();\n            })\n            // api.uploadData(formData, config.url.uploadData).then((response) => {\n            //     this.setState({ operateState: OperationType.GENERATING }); //加快页面交互的响应\n            //     if (response.status === 'error') {\n            //         let { intl } = this.props\n            //         this.setState({\n            //             operateState: OperationType.FAILED,\n            //             errorMessage: intl.options.currentLocale === 'zh-CN' ? response.message_zh : response.message_en\n            //         })\n            //         reject();\n            //         return null;\n            //     }\n            //     reslove(response);\n            // }, fail => {\n            //     this.setState({\n            //         operateState: OperationType.FAILED,\n            //         errorMessage: this.props.initDone && this.props.intl.get(\"upload failed\")\n            //     })\n            //     reject();\n            // })\n        })\n    }\n\n    processData = (response) => {\n        if (!response.data.schema || !response.data.file_url || !response.data.filename) {\n            this.props.updateOperation(OperationType.UPLOADED)//更新UI\n            return\n        }\n        let schema = response.data.schema\n        let fileURL = response.data.file_url\n        let fileName = response.data.filename\n        let numericalFields = []\n        let numerical = schema.filter(d => d.type === \"numerical\")\n        numericalFields = numerical.map(d => d.field)\n        let _that = this\n        d3.csv(fileURL)\n            .then(function (data) {\n                data.forEach((d, i) => {\n                    for (let key in d) {\n                        if (numericalFields.indexOf(key) !== -1) {\n                            d[key] = parseFloat(d[key])\n                        }\n                    }\n                })\n                _that.props.uploadData(fileName, schema, data,fileURL); //更新数据到redux中\n                _that.props.updateOperation(OperationType.UPLOADED)//更新UI\n            }).catch(function (error) {\n                console.log(error)\n            })\n    }\n\n    onUploadChange = (info) => {\n        /**** update UI ****/\n        this.setState({\n            operateState: OperationType.UPLOADIND,\n        })\n        if (info.event) {\n            this.props.updateProgress(info.event.total, (info.event.total - info.event.loaded));\n        }\n        /**** update UI  the end ****/\n\n        const { status } = info.file;\n        if (status !== 'uploading') {\n            \n            let fileObj = info.file.originFileObj;\n            let formData = new FormData();\n            formData.append(\"file\", fileObj);\n            //step:1 upload data\n            this.uploadDataToCloud(formData)\n                //step 2:process data\n                .then((response) => this.processData(response))\n        }\n    }\n    beforeUpload = (info) => {\n        return new Promise((resolve, reject) => {\n            if (info.size <= 1048576 * 5) {\n                return resolve(true);\n            } else {\n                this.setState({\n                    operateState: OperationType.FILE_LARGE\n                })\n                reject(false);\n            }\n        });\n    }\n\n    getPannelClassName = () => {\n        const { operateState } = this.state;\n        switch (operateState) {\n            case OperationType.BEFORE_UPLOAD:\n                return \"draggerPannelCommon yellowPannel\";\n            case OperationType.UPLOADED:\n                return \"pannelWithConvertType whitePannel\";\n\n            default:\n                return \"\";\n        }\n    }\n\n    isShowProgressbar = () => {\n        const { operateState } = this.state;\n        if (operateState === OperationType.UPLOADIND || operateState === OperationType.GENERATING) {\n            return true;\n        }\n        return false;\n    }\n\n\n    render() {\n        const { intl, initDone, generateProgress } = this.props;\n        const { operateState } = this.state;\n\n\n        /***\n            上传失败或者文件过大的情况下，点击此按钮可以重新上传\n            ***/\n        const ClickToUploadView = () => {\n            return (\n                <div className=\"ClickToUpload\">\n                    <div ></div>\n                    <p> {initDone && intl.get(\"Click to upload\")}</p>\n                </div>\n            )\n        };\n\n        let PannelContentView;\n        switch (operateState) {\n            case OperationType.BEFORE_UPLOAD:\n                PannelContentView = <>\n                    <div className=\"CSVFileImage\">\n                        <div className='csvIconWhite'></div>\n                    </div>\n                    <div className=\"uploadView\">\n                        <div className=\"uploadBtn\">\n                            <div></div>\n                            {initDone && intl.get(\"Click to upload\")}\n                        </div>\n                        <span>{initDone && intl.get(\"or drag a csv file here\")} </span>\n                    </div>\n                </>\n                break;\n            case OperationType.UPLOADIND:\n                PannelContentView = <div className=\"uploading\">\n                    <div className='uploadImage'></div>\n                    <span>{initDone && intl.get(\"Uploading file\")}</span>\n                    <div className='dot'>...</div>\n                </div>\n                break;\n            case OperationType.FAILED:\n                PannelContentView = <>\n                    <div className='errorFailImage'>\n                        <div className=\"iconFailed\"></div>\n                        <p className=\"hintText\">{this.state.errorMessage}</p>\n                    </div>\n                    <ClickToUploadView />\n                </>\n                break;\n            case OperationType.FILE_LARGE: //large than 5MB\n                PannelContentView = <>\n                    <div className=\"largeFileView\">\n                        <div></div>\n                        <span>{initDone && intl.get(\"larger than 5MB\")}</span>\n                    </div>\n                    <ClickToUploadView />\n                </>\n                break;\n            default:\n                break;\n        }\n\n        return (\n            <div className={this.getPannelClassName()} style={{ position: 'relative' }}>\n                <ProgressBarView percent={generateProgress} isActive={this.isShowProgressbar()} />\n                <div style={{ height: \"340px\", flex: 1 }}>\n                    <Dragger\n                        beforeUpload={this.beforeUpload}\n                        onChange={this.onUploadChange}\n                        showUploadList={false}\n                        accept=\".csv, .json\">\n                        <div className=\"pannelContent\">\n                            {\n                                PannelContentView\n                            }\n                        </div>\n                    </Dragger>\n                </div>\n            </div >\n        )\n    }\n}","const AliCloud = 'http://calliope-dev.oss-cn-shanghai.aliyuncs.com/image/images'\nexport default AliCloud","import ConvertType from './ConvertType'\nimport AliCloud from '@/constant/imageUrl'\n\nlet ConvertForms = [\n    {\n        name: ConvertType.TIMESEIRES,\n        iconUrl: `${AliCloud}/convertType/factsheet.png`,\n        generateIconUrl: `${AliCloud}/convertType/factsheet_black.png`\n    },\n    // {\n    //     name: ConvertType.FACTSHEET,\n    //     iconUrl: `${AliCloud}/convertType/factsheet.png`,\n    //     generateIconUrl: `${AliCloud}/convertType/factsheet_black.png`\n    // },\n    // {\n    //     name: ConvertType.H5,\n    //     iconUrl: '${AliCloud}/convertType/H5.png',\n    //     generateIconUrl: '${AliCloud}/convertType/H5_black.png'\n    // }\n]\nexport default ConvertForms;","\nimport React from 'react'\nimport './ButtonBoxView.less'\n\n\nexport default class ButtonBoxView extends React.Component {\n\n    render() {\n        const { iconUrl, text } = this.props\n        return <div className='button-box' onClick={() => this.props.onClickListener()}>\n            <div style={{ backgroundImage: `url(${iconUrl})` }}></div>\n            <p>{text}</p>\n        </div>\n\n    }\n}","\nimport React from 'react'\nimport { Spin } from 'antd';\nimport './SpiningView.less'\n\nexport default class SpiningView extends React.Component {\n\n    render() {\n        const { isSpining, initDone, intl } = this.props\n        return <>\n            <Spin tip={initDone && intl.get(\"downloading\")} spinning={isSpining} />\n        </>\n    }\n}","\nimport React from 'react'\nimport SpiningView from '../Spining/SpiningView';\nimport './CommonSlotView.less'\nimport '../../common.less'\n\n\n/**** 定义组件的外观***/\nexport default class CommonSlotView extends React.Component {\n    render() {\n        const { fileName, initDone, intl, columnCount, form, isSpining } = this.props\n        let pdfName = fileName && fileName.split(\".csv\")[0]\n\n        const FileTypeAndNameView = () => {\n            return <div className='fileTypeAndNameView' style={{ justifyContent: isSpining ? \"flex-start\" : \"center\" }}>\n                <div className='fileType-icon'></div>\n                <span style={{ marginBottom: \"0px\" }} >{form === \"H5\" ? '' : `${pdfName}.pdf`}</span>\n            </div>\n        }\n\n        return <div className={this.props.myClassName ? `generated-view-dox ${this.props.myClassName}` : 'generated-view-dox'}>\n            <span >{initDone && intl.get(form === \"H5\" ? \"convertedTxtH5\" : \"convertedTxt\")}</span>\n            <FileTypeAndNameView />\n            <div className=\"FuntionView\" style={{ columnCount }}>\n                <div className='download-box'>\n                    <SpiningView isSpining={isSpining} {...this.props} />\n                </div>\n                {\n                    this.props.children\n                }\n            </div>\n            <span >{initDone && intl.get(\"Visit\")}<a style={{ padding: '0px 5px' }} href='https://datacalliope.com' target=\"_blank\" rel=\"noopener noreferrer\">Calliope · Data</a>{initDone && intl.get(\"VisitCalliope\")}</span>\n        </div>\n    }\n}","import React from 'react'\nimport ConvertForms from '@/constant/config'\nimport OperationType from '@/constant/OperationType'\nimport ButtonBoxView from '../Components/ButtonBox/ButtonBoxView'\nimport CommonSlotView from '../Components/commonSlot/CommonSlotView'\nimport AliCloud from '@/constant/imageUrl'\nimport * as api from '@/axios/api'\nimport './ToFactsheet.less'\nimport '../common.less'\n\n\nexport default class ToFactsheet extends React.Component {\n\n    state = {\n        isDownloading: false\n    }\n\n    download = () => {\n        this.setState({\n            isDownloading: true\n        })\n        //pdf下载功能\n        let data = {\n\n        }\n        api.generatePDF(data).then(() => { })\n    }\n\n    reUpload = () => {\n        this.props.updateOperation(OperationType.BEFORE_UPLOAD)\n    }\n    reGnerate = () => {\n        this.props.reGnerate(ConvertForms[0])\n    }\n    editPage = () => {\n        this.props.history.push('/edit/factsheet')\n    }\n    click = (text) => {\n        const { intl, initDone } = this.props;\n        switch (text) {\n            case initDone && intl.get(\"Upload\"):\n                this.reUpload()\n                break;\n            case initDone && intl.get(\"Regnerate\"):\n                this.reGnerate()\n                break;\n            case initDone && intl.get(\"Download\"):\n                this.download()\n                break;\n            case initDone && intl.get(\"Edit\"):\n                this.editPage()\n                break;\n            default:\n                break;\n        }\n    }\n\n    render() {\n        const { intl, initDone, fileName } = this.props;\n        const { isDownloading } = this.state\n        //add your button here\n        const supportedButton = [\n            {\n                iconUrl: `${AliCloud}/upload_white.png`,\n                text: initDone && intl.get(\"Upload\")\n            },\n            {\n                iconUrl: `${AliCloud}/download/regenerate.png`,\n                text: initDone && intl.get(\"Regnerate\")\n            },\n            {\n                iconUrl: `${AliCloud}/download/download.png`,\n                text: initDone && intl.get(\"Download\")\n            },\n            {\n                iconUrl: `${AliCloud}/download/edit.png`,\n                text: initDone && intl.get(\"Edit\")\n            }\n        ]\n        return (\n            <CommonSlotView myClassName={\"toFactsheet\"} fileName={fileName} isSpining={isDownloading} columnCount={supportedButton.length} {...this.props}>\n                {\n                    supportedButton.map((button, index) => {\n                        return <ButtonBoxView key={\"index_\" + index} iconUrl={button.iconUrl} text={button.text} onClickListener={() => this.click(button.text)} />\n                    })\n                }\n            </CommonSlotView >\n        )\n    }\n}\n","export default {\n    GREEN: 'rgb(51, 111, 185)',\n    YELLOW: 'yellow',\n    BLUE: '#336fb9',\n    GRAY: 'lightgray',\n    BAR_BACK: '#222f3d',\n    BAR: '#6CD4FF',\n    BAR_HIGHTLIGHT: '#F6C02A',\n    AREA: '#ffce54',\n    LINE: '#ffce54',\n    BG_ABOVE: '#a1d469',\n    BG_BELOW: '#ed5463',\n    CONVERT: [\"#064969\", \"#E19788\", \"#D33346\", \"#96A7CE\", \"#B1CC70\", \"#4ECBC4\"]\n}","import React, { Suspense } from 'react'\nimport { Spin } from 'antd';\nimport OperationType from '@/constant/OperationType'\nimport ConvertType from '@/constant/ConvertType'\nimport ConvertForms from '@/constant/config'\nimport Fact from '@/model/fact'\nimport ToFactsheet from '@/components/Generate/ToFactsheet/ToFactsheet'\nimport Color from '@/constant/Color'\nimport ProgressBarView from '@/components/ProgressBar/ProgressBarView'\nimport config from '@/axios/config';\nimport * as api from '@/axios/api';\nimport './GeneratePannel.less';\nimport { parsingFile } from '../../axios';\n\n\nexport default class GeneratePannel extends React.Component {\n\n    state = {\n        operateState: this.props.operateState,\n        convertingType: ConvertForms[0]\n    }\n\n    UNSAFE_componentWillReceiveProps(nextProps) {\n        if (nextProps.operateState !== this.props.operateState) {\n            this.setState({\n                operateState: nextProps.operateState\n            })\n        }\n    }\n    generate = (fileurl) => {\n        return new Promise(async (resolve, reject) => {\n            let fileName = this.props.fileName;\n            this.props.generateStory([], [], '');\n            this.props.updateProgress(this.props.maxStoryLength, this.props.maxStoryLength);//reset progress bar\n            //setTimeout 8s\n            let max_iteration = 8,\n                count = max_iteration;//inital\n\n            let timer = setInterval(() => {\n                if (count === 0) {\n                    clearInterval(timer)\n                    this.setState({\n                        operateState: OperationType.GENERATED\n                    })\n                    this.props.history.push('/edit')\n                }\n                count--;\n                this.props.updateProgress(max_iteration, count < 0 ? 0 : count);\n            }, 1500)\n\n            const { storyParameter } = this.props;\n\n            let data = {\n                file_name: fileName,\n                max_story_length: storyParameter.maxStoryLength\n            }\n            // const response = await api.generate(url, data)\n            const response = await parsingFile(fileurl)\n            clearInterval(timer);\n            if (response.data.fail) {\n                this.setState({\n                    operateState: OperationType.FAILED,\n                    errorMessage: response.data.fail\n                })\n                reject();\n            }\n            if (response.data.error) {\n                this.setState({\n                    operateState: OperationType.FAILED,\n                    errorMessage: response.data.error\n                })\n                reject();\n            }\n            this.props.updateProgress(max_iteration, 0);//100%\n            this.setState({\n                operateState: OperationType.GENERATED\n            })\n            resolve(response)\n        })\n    }\n\n    getPannelClassName = () => {\n        const { operateState } = this.state;\n        switch (operateState) {\n            case OperationType.UPLOADED:\n                return \"pannelWithConvertType whitePannel\"\n            case OperationType.GENERATING:\n            case OperationType.GENERATED:\n                return \"draggerPannelCommon whitePannel\"\n            default:\n                return \"\";\n        }\n    }\n\n    isShowProgressbar = () => {\n        const { operateState } = this.state\n        if (operateState === OperationType.GENERATING) {\n            return true;\n        }\n        return false;\n    }\n\n    clickGenerate = (typeForm) => {\n        this.setState({\n            convertingType: typeForm,\n            operateState: OperationType.GENERATING\n        })\n        let type = typeForm.name\n        // console.log()\n        this.generate(this.props.originFileUrl).then(response => {\n\n            let result=response.data\n            //set columnList,granularity,dataRange,timeCol,timeValue\n            this.props.setParsedFileData(result.columns,\n                                         result.granularity,\n                                         [0,this.props.originData.length-1],\n                                         result.timeColumns,\n                                         result.timeValues)\n            //设置一个\n            this.props.history.push('/edit')\n            // const facts = response.data.story.facts;\n            // let tempFacts = [];\n            // switch (type) {\n            //     default:\n            //         for (let factDict of facts) {\n            //             let fact = new Fact(\n            //                 factDict['type'],\n            //                 factDict['measure'],\n            //                 factDict['subspace'],\n            //                 factDict['groupby'],\n            //                 factDict['focus'],\n            //                 factDict['parameter'],\n            //                 \"\", // chart\n            //                 factDict['score'],\n            //                 factDict['information'],\n            //                 factDict['significance']\n            //             )\n            //             tempFacts.push(fact);\n            //         }\n            //         this.props.generateStory(tempFacts.slice(), [\n            //             \"none\",\n            //             \"similarity\",\n            //             \"similarity\",\n            //             \"similarity\",\n            //             \"similarity\",\n            //             \"similarity\"\n            //         ], 1);\n            //         this.props.history.push('/edit')\n            //         break;\n            // }\n        })\n    }\n\n    render() {\n        const { intl, initDone, generateProgress } = this.props;\n        const { operateState, convertingType } = this.state\n\n\n        const ConvertingArrow = ({ operateState }) => {\n            return (<div className=\"arrowLineDiv\" >\n                <p> {this.props.generateProgress + \"%\"}</p>\n                <div className=\"arrowLine\"></div>\n                {\n                    operateState === OperationType.GENERATED ?\n                        <p> {initDone && intl.get(\"Success\")}</p>\n                        :\n                        <p> {initDone && intl.get(\"Coverting\")}</p>\n                }\n            </div>)\n        }\n\n        const FileNameView = ({ fileName }) => {\n            return <div className='CSVFileImage'>\n                <div className='csvIconBlack'></div>\n                <span className=\"fileName\">{fileName}</span>\n            </div>\n        }\n\n        let PannelContentView;\n        switch (operateState) {\n            case OperationType.UPLOADED:\n                PannelContentView = <>\n                    <div style={{ height: \"340px\", flex: 1 }}>\n                        <div className='pannel-box'>\n                            <FileNameView fileName={this.props.fileName} />\n                        </div>\n                    </div>\n                    <div className='ConvertFormsDiv' style={{ columnCount: Math.ceil(ConvertForms.length / 2) }}>\n                        {\n                            ConvertForms.map((type, idx) => {\n                                return <div className='convert-box'\n                                    key={idx}\n                                    style={{ height: ConvertForms.length === 1 ? \"100%\" : \"50%\", backgroundColor: Color.CONVERT[idx] }}\n                                    onClick={() => this.clickGenerate(type)}>\n                                    <div className='icon'\n                                        style={{ backgroundImage: `url(${type.iconUrl})` }}\n                                    />\n                                    <span>{initDone && intl.get(`To${type.name}`)}</span>\n                                </div>\n                            })\n                        }\n                        {\n                            ConvertForms.length !== 1 && ConvertForms.length % 2 !== 0 ?\n                                <div style={{ height: \"50%\", visibility: \"none\", backgroundColor: \"transparent\" }}></div>\n                                : null\n                        }\n                    </div>\n                </>\n                break;\n            case OperationType.GENERATING:\n                PannelContentView = <div style={{ height: \"340px\", flex: 1 }}>\n                    <div className='pannel-box'>\n                        <div style={{ display: 'flex' }}>\n                            <FileNameView fileName={this.props.fileName} />\n                            <div className='VHCenter'>\n                                <ConvertingArrow operateState={operateState} {...this.props} />\n                                <div className='CSVFileImage'>\n                                    <div className='GenerateIcon'\n                                        style={{ backgroundImage: `url(${convertingType.generateIconUrl})` }}\n                                    />\n                                    <span className='fileName'>{initDone && intl.get(`To${convertingType.name}`)}</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div >\n                break;\n            case OperationType.PUBLISHED:\n                const Loading = () => {\n                    return (<div style={{ width: '100%', height: '100%', display: 'flex', justifyContent: 'center', marginTop: \"50px\" }}>\n                        <Spin />\n                    </div>)\n                }\n                //dynamic load the supported button view according to the convert type\n                let GeneratedPannel;\n                switch (convertingType.name) {\n                    case ConvertType.FACTSHEET:\n                        GeneratedPannel = <ToFactsheet reGnerate={this.clickGenerate}  {...this.props} />\n                        break;\n                    default:\n                        break;\n                }\n\n                PannelContentView = <div style={{ height: \"340px\", flex: 1 }}>\n                    <div className='pannel-box'>\n                        <div style={{ display: 'flex', flexDirection: \"column\", alignItems: \"center\", height: \"100%\" }}>\n                            <Suspense fallback={<Loading />}>\n                                {GeneratedPannel}\n                            </Suspense>\n                        </div>\n                    </div>\n                </div >\n                break;\n            default:\n                break;\n        }\n        return <div className={this.getPannelClassName()}>\n            <ProgressBarView percent={generateProgress} isActive={this.isShowProgressbar()} />\n            {\n                PannelContentView\n            }\n        </div>\n    }\n}","import React, { Component } from 'react'\nimport OperationType from '@/constant/OperationType'\n\nimport UploadPannel from '@/components/Upload/UploadPannel'\nimport GeneratePannel from '@/components/Generate/GeneratePannel'\nimport './PannelView.less'\n\n/***上传与生成组件****/\nexport default class PannelView extends Component {\n    render() {\n        const { intl, initDone, operateState } = this.props;\n        let PannelView;\n        switch (operateState) {\n            //upload module\n            case OperationType.BEFORE_UPLOAD:\n            case OperationType.UPLOADIND:\n            case OperationType.FAILED:\n            case OperationType.FILE_LARGE:\n                PannelView = <UploadPannel operateState={operateState} {...this.props} />\n                break;\n            //generate module\n            case OperationType.UPLOADED:\n            case OperationType.GENERATING:\n            case OperationType.PUBLISHED:\n                PannelView = <GeneratePannel operateState={operateState} {...this.props} />\n                break;\n            default:\n                break;\n        }\n\n        return <div>\n            <div className='UploadTxtDiv'><div></div> <span>{initDone && intl.get(\"UploadDescription\")}</span></div>\n            {\n                PannelView\n            }\n        </div>\n    }\n}\n"],"sourceRoot":""}